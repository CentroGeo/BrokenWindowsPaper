<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>BOOK_PAPER - 2&nbsp; Data Acquisition and Preprocessing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./methods.html" rel="next">
<link href="./intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Acquisition and Preprocessing</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">BOOK_PAPER</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Acquisition and Preprocessing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./methods.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#adquisition" id="toc-adquisition" class="nav-link active" data-scroll-target="#adquisition"><span class="toc-section-number">3</span>  Adquisition</a></li>
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing"><span class="toc-section-number">4</span>  Preprocessing</a>
  <ul class="collapse">
  <li><a href="#concentración-de-desventajas" id="toc-concentración-de-desventajas" class="nav-link" data-scroll-target="#concentración-de-desventajas"><span class="toc-section-number">4.1</span>  Concentración de desventajas</a>
  <ul class="collapse">
  <li><a href="#análisis-de-componentes-principales-pca" id="toc-análisis-de-componentes-principales-pca" class="nav-link" data-scroll-target="#análisis-de-componentes-principales-pca"><span class="toc-section-number">4.1.1</span>  Análisis de Componentes Principales (PCA)</a></li>
  <li><a href="#nivel-colonias" id="toc-nivel-colonias" class="nav-link" data-scroll-target="#nivel-colonias"><span class="toc-section-number">4.1.2</span>  Nivel Colonias</a></li>
  <li><a href="#nivel-alcaldias" id="toc-nivel-alcaldias" class="nav-link" data-scroll-target="#nivel-alcaldias"><span class="toc-section-number">4.1.3</span>  Nivel Alcaldias</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#desorden-social-y-físico" id="toc-desorden-social-y-físico" class="nav-link" data-scroll-target="#desorden-social-y-físico"><span class="toc-section-number">5</span>  Desorden Social y Físico</a>
  <ul class="collapse">
  <li><a href="#el-jardín-de-las-bifurcaciones" id="toc-el-jardín-de-las-bifurcaciones" class="nav-link" data-scroll-target="#el-jardín-de-las-bifurcaciones"><span class="toc-section-number">5.1</span>  El jardín de las bifurcaciones</a>
  <ul class="collapse">
  <li><a href="#corrección-columna-clave-de-manzana" id="toc-corrección-columna-clave-de-manzana" class="nav-link" data-scroll-target="#corrección-columna-clave-de-manzana"><span class="toc-section-number">5.1.1</span>  Corrección columna clave de manzana</a></li>
  <li><a href="#caso-por-mananzas-y-clave-manzanas" id="toc-caso-por-mananzas-y-clave-manzanas" class="nav-link" data-scroll-target="#caso-por-mananzas-y-clave-manzanas"><span class="toc-section-number">5.1.2</span>  <strong>Caso por Mananzas y Clave Manzanas</strong></a></li>
  <li><a href="#desorden-social-y-fisico-a-nivel-colonia" id="toc-desorden-social-y-fisico-a-nivel-colonia" class="nav-link" data-scroll-target="#desorden-social-y-fisico-a-nivel-colonia"><span class="toc-section-number">5.1.3</span>  Desorden Social y Fisico a nivel Colonia</a></li>
  <li><a href="#desorden-social-y-fisico-a-nivel-alcaldia" id="toc-desorden-social-y-fisico-a-nivel-alcaldia" class="nav-link" data-scroll-target="#desorden-social-y-fisico-a-nivel-alcaldia"><span class="toc-section-number">5.1.4</span>  Desorden Social y Fisico a nivel Alcaldia</a></li>
  <li><a href="#caso-por-mananzas-y-puntos-geom" id="toc-caso-por-mananzas-y-puntos-geom" class="nav-link" data-scroll-target="#caso-por-mananzas-y-puntos-geom"><span class="toc-section-number">5.1.5</span>  <strong>Caso por Mananzas y Puntos Geom</strong></a></li>
  <li><a href="#contabilizando-los-puntos-dentro-de-poligonos" id="toc-contabilizando-los-puntos-dentro-de-poligonos" class="nav-link" data-scroll-target="#contabilizando-los-puntos-dentro-de-poligonos"><span class="toc-section-number">5.1.6</span>  Contabilizando los puntos dentro de poligonos</a></li>
  <li><a href="#desorden-social-y-fisico-nivel-colonia" id="toc-desorden-social-y-fisico-nivel-colonia" class="nav-link" data-scroll-target="#desorden-social-y-fisico-nivel-colonia"><span class="toc-section-number">5.1.7</span>  Desorden Social y Fisico nivel colonia</a></li>
  <li><a href="#desorden-social-y-fisico-nivel-alcaldia" id="toc-desorden-social-y-fisico-nivel-alcaldia" class="nav-link" data-scroll-target="#desorden-social-y-fisico-nivel-alcaldia"><span class="toc-section-number">5.1.8</span>  Desorden Social y Fisico nivel Alcaldia</a></li>
  <li><a href="#resultados" id="toc-resultados" class="nav-link" data-scroll-target="#resultados"><span class="toc-section-number">5.1.9</span>  Resultados</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Acquisition and Preprocessing</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="adquisition" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Adquisition</h1>
<p><a href="https://www.inegi.org.mx/programas/ccpv/2020/default.html#Microdatos">Censo de poblacion 2020</a></p>
<p><a href="https://www.inegi.org.mx/app/descarga/?ti=13&amp;ag=01">Descarga masiva Manzanas</a></p>
<p><a href="https://datos.cdmx.gob.mx/dataset/llamadas-numero-de-atencion-a-emergencias-911">Llamadas del 911</a></p>
</section>
<section id="preprocessing" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Preprocessing</h1>
<section id="concentración-de-desventajas" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="concentración-de-desventajas"><span class="header-section-number">4.1</span> Concentración de desventajas</h2>
<p>Construido a partir de cuatro dimensiónes (con base a censo 2010) y reducidad a una componente principal por PCA. Las dimensiones que se exponen en el articulo son: - Porcentaje de masculinos de 15 a 29 - Porcentaje de población sin servicios a salud - Promedio de habitantes que ocupan un hogar privado - Porcentaje de personas que hablan una lengua indigena</p>
<p>Con base al Censo de población de 2020, las dimensiones se resumen de la forma:</p>
<div class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">Clave</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">P_15A17_M</td>
<td style="text-align: left;">Población masculina de 15 a 17 años</td>
</tr>
<tr class="even">
<td style="text-align: left;">P_18A24_M</td>
<td style="text-align: left;">Población masculina de 18 a 24 años</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSINDER</td>
<td style="text-align: left;">Población sin afiliación a servicios de salud</td>
</tr>
<tr class="even">
<td style="text-align: left;">PROM_OCUP</td>
<td style="text-align: left;">Promedio de ocupantes en viviendas particulares habitadas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P3YM_HLI</td>
<td style="text-align: left;">Población de 3 años y más que habla alguna lengua indígena</td>
</tr>
</tbody>
</table>
</div>
</div>
<blockquote class="blockquote">
<blockquote class="blockquote">
<p>La primer parte consta de cargar la base de datos de censo, seleccionar las dimensiones, limpiar la información y preparala para poder hacerla únion de estas en la geometry de la unidd geografica manzanas. Se cargan las librerias necesarias.</p>
</blockquote>
</blockquote>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Librerias </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> contextily <span class="im">as</span> ctx</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">### Warnings</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Se carga la información del Censo por unidad manzanas conservando unicamente los campos de interes: <strong>ENTIDAD, NOM_ENT, MUN, NOM_MUN LOC, NOM_LOC, AGEB, MZA, POBTOT, P_15A17_M, P_18A24_M, PSINDER, PROM_OCUP y P3YM_HLI</strong></p>
</blockquote>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>CENSO_2020 <span class="op">=</span>  pd.read_csv(Entradas <span class="op">+</span> <span class="st">'MANZANAS.csv'</span>, encoding <span class="op">=</span> <span class="st">'Latin-1'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>CENSO_2020 <span class="op">=</span> CENSO_2020 [[<span class="st">'ENTIDAD'</span>,<span class="st">'NOM_ENT'</span>,<span class="st">'MUN'</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'NOM_MUN'</span>,<span class="st">'LOC'</span>,<span class="st">'NOM_LOC'</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'AGEB'</span>,<span class="st">'MZA'</span>,<span class="st">'POBTOT'</span>, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'P_15A17_M'</span>,<span class="st">'P_18A24_M'</span>,<span class="st">'PSINDER'</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'PROM_OCUP'</span>, <span class="st">'P3YM_HLI'</span>]]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>CENSO_2020.head(<span class="dv">2</span>)                          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>AGEB</th>
      <th>MZA</th>
      <th>POBTOT</th>
      <th>P_15A17_M</th>
      <th>P_18A24_M</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9</td>
      <td>Ciudad de México</td>
      <td>0</td>
      <td>Total de la entidad Ciudad de México</td>
      <td>0</td>
      <td>Total de la entidad</td>
      <td>0</td>
      <td>0</td>
      <td>9209944</td>
      <td>193870</td>
      <td>496288</td>
      <td>2502789</td>
      <td>3.32</td>
      <td>125153</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
      <td>Ciudad de México</td>
      <td>2</td>
      <td>Azcapotzalco</td>
      <td>0</td>
      <td>Total del municipio</td>
      <td>0</td>
      <td>0</td>
      <td>432205</td>
      <td>8382</td>
      <td>21785</td>
      <td>90370</td>
      <td>3.21</td>
      <td>3208</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>De la base de datos filtramos eliminando las filas que contienen los totales</p>
</blockquote>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Values <span class="op">=</span> [<span class="st">'Total de la entidad'</span>,<span class="st">'Total del municipio'</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">'Total de la localidad urbana'</span>, <span class="st">'Total AGEB urbana'</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE <span class="op">=</span> CENSO_2020.query(<span class="st">"NOM_LOC != @Values"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>AGEB</th>
      <th>MZA</th>
      <th>POBTOT</th>
      <th>P_15A17_M</th>
      <th>P_18A24_M</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>Ciudad de México</td>
      <td>2</td>
      <td>Azcapotzalco</td>
      <td>1</td>
      <td>Azcapotzalco</td>
      <td>10</td>
      <td>1</td>
      <td>159</td>
      <td>*</td>
      <td>8</td>
      <td>27</td>
      <td>3.31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9</td>
      <td>Ciudad de México</td>
      <td>2</td>
      <td>Azcapotzalco</td>
      <td>1</td>
      <td>Azcapotzalco</td>
      <td>10</td>
      <td>2</td>
      <td>145</td>
      <td>*</td>
      <td>7</td>
      <td>46</td>
      <td>3.45</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Dentro de la base de datos existe la presencia de filas donde los valores son simbolos o caracteres especiales(*, N/D, 99999, etc), por lo que es necesario remplazarlos por valores NAN.</p>
</blockquote>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE <span class="op">=</span> CENSO_2020_USE.replace({<span class="st">'999999999'</span>: np.nan, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">'99999999'</span>: np.nan,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">'*'</span>: np.nan,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">'N/D'</span>: np.nan})</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>DIM_NUM <span class="op">=</span> CENSO_2020_USE.iloc[: , <span class="op">-</span><span class="dv">6</span>:].columns.tolist()</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>DIM_TEXT <span class="op">=</span> CENSO_2020_USE.iloc[:, :<span class="dv">8</span>].columns.tolist()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE[DIM_NUM] <span class="op">=</span> CENSO_2020_USE[DIM_NUM].astype(<span class="st">'float'</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE[DIM_TEXT] <span class="op">=</span> CENSO_2020_USE[DIM_TEXT].astype(<span class="bu">str</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>De igual manera la información referida a a las columnas de “Entidad, Municipio, Localidad, AGEB y Manzana”, no presetan el formato necesario para crear la columna CVEGEO, por lo que debemos completar la información de la forma correcta.</p>
</blockquote>
<blockquote class="blockquote">
<p>Creada la columna CVEGEO, calculamos la dimensión población masculina de 15 a 24 años como la suma de “P_15A17_M y P_18A24_M”. Una vez que hemos creado la dimensión se hacen poco necesarias “P_15A17_M y P_18A24_M, por lo que se eliminan.</p>
</blockquote>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Corrección de información</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE[<span class="st">'ENTIDAD'</span>] <span class="op">=</span> CENSO_2020_USE[<span class="st">'ENTIDAD'</span>].<span class="bu">str</span>.zfill(<span class="dv">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE[<span class="st">'MUN'</span>] <span class="op">=</span> CENSO_2020_USE[<span class="st">'MUN'</span>].<span class="bu">str</span>.zfill(<span class="dv">3</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE[<span class="st">'LOC'</span>] <span class="op">=</span> CENSO_2020_USE[<span class="st">'LOC'</span>].<span class="bu">str</span>.zfill(<span class="dv">4</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE[<span class="st">'AGEB'</span>] <span class="op">=</span> CENSO_2020_USE[<span class="st">'AGEB'</span>].<span class="bu">str</span>.zfill(<span class="dv">4</span>)  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE[<span class="st">'MZA'</span>] <span class="op">=</span> CENSO_2020_USE[<span class="st">'MZA'</span>].<span class="bu">str</span>.zfill(<span class="dv">3</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE[<span class="st">'CVEGEO'</span>] <span class="op">=</span> CENSO_2020_USE[[<span class="st">'ENTIDAD'</span>, <span class="st">'MUN'</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'LOC'</span>,<span class="st">'AGEB'</span>,<span class="st">'MZA'</span>]].agg(<span class="st">''</span>.join, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Cálculo de Población masculina de 15 a 24 años</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE[<span class="st">'P_15A24_M'</span>] <span class="op">=</span> CENSO_2020_USE[[<span class="st">"P_15A17_M"</span>, </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"P_18A24_M"</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                                                                min_count<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">## Eliminación de dimensiones</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE <span class="op">=</span> CENSO_2020_USE.drop([<span class="st">'P_15A17_M'</span>,<span class="st">'P_18A24_M'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>CENSO_2020_USE.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>AGEB</th>
      <th>MZA</th>
      <th>POBTOT</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>CVEGEO</th>
      <th>P_15A24_M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>002</td>
      <td>Azcapotzalco</td>
      <td>0001</td>
      <td>Azcapotzalco</td>
      <td>0010</td>
      <td>001</td>
      <td>159.0</td>
      <td>27.0</td>
      <td>3.31</td>
      <td>0.0</td>
      <td>0900200010010001</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>002</td>
      <td>Azcapotzalco</td>
      <td>0001</td>
      <td>Azcapotzalco</td>
      <td>0010</td>
      <td>002</td>
      <td>145.0</td>
      <td>46.0</td>
      <td>3.45</td>
      <td>0.0</td>
      <td>0900200010010002</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Se carga la base de datos geoespacial que corresponde a la unidad geografica de “manzanas”. Para este caso, el archivo se encuentra en formato “json”. Del archivo, unicamente consideramos las columnas “CVEGEO y geometry”</p>
</blockquote>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Se carga el archivo espacial de Manzanas</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>MANZA_CDMX <span class="op">=</span> gpd.read_file(Entradas <span class="op">+</span><span class="st">'MANZA_CDMX.json'</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>MANZA_CDMX <span class="op">=</span> MANZA_CDMX[[<span class="st">'CVEGEO'</span>,<span class="st">'geometry'</span>]]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>MANZA_CDMX.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVEGEO</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0901000010898031</td>
      <td>POLYGON ((-99.22982 19.35939, -99.23006 19.359...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0901000012269024</td>
      <td>POLYGON ((-99.21840 19.36539, -99.21848 19.365...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Union (merge) de las unidades geoespaciales con la información del Censo de Población y vivienda 2020. En este punto a cada unidad geografica le asignamos la información del censo de población.</p>
</blockquote>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Union a la izquierda con campo llave primaria "CVEGEO"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>MERGE <span class="op">=</span> MANZA_CDMX.merge( CENSO_2020_USE,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                          left_on <span class="op">=</span> <span class="st">'CVEGEO'</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                          right_on <span class="op">=</span> <span class="st">'CVEGEO'</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                          how <span class="op">=</span> <span class="st">'inner'</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>MERGE.head(<span class="dv">2</span>)          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVEGEO</th>
      <th>geometry</th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>AGEB</th>
      <th>MZA</th>
      <th>POBTOT</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>P_15A24_M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0901000010898031</td>
      <td>POLYGON ((-99.22982 19.35939, -99.23006 19.359...</td>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>0898</td>
      <td>031</td>
      <td>93.0</td>
      <td>16.0</td>
      <td>4.04</td>
      <td>0.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0901000012269024</td>
      <td>POLYGON ((-99.21840 19.36539, -99.21848 19.365...</td>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>2269</td>
      <td>024</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Siempre es importante saber en que sistema de proyección se encuentran nuestros datos, para eso usamos “crs”</p>
</blockquote>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>MERGE.crs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;Geographic 2D CRS: EPSG:4326&gt;
Name: WGS 84
Axis Info [ellipsoidal]:
- Lat[north]: Geodetic latitude (degree)
- Lon[east]: Geodetic longitude (degree)
Area of Use:
- name: World
- bounds: (-180.0, -90.0, 180.0, 90.0)
Datum: World Geodetic System 1984
- Ellipsoid: WGS 84
- Prime Meridian: Greenwich</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Hacemos un mapa por que nos gustan los mapitas.</p>
</blockquote>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> MERGE.plot(ax <span class="op">=</span> ax, column<span class="op">=</span><span class="st">'P_15A24_M'</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                scheme<span class="op">=</span><span class="st">'NaturalBreaks'</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                cmap<span class="op">=</span><span class="st">'copper'</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                classification_kwds<span class="op">=</span>{<span class="st">'k'</span>:<span class="dv">6</span>})</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'Población Masculina 15 a 24 años, Ciudad de México'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>ax.set_axis_off()</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data_files/figure-html/cell-12-output-1.png" width="504" height="631"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Hasta el punto anterior tenemos la información contenida dentro de las manzanas, el paso que sigue es llevar las manzanas a colonias. Para esto es necesario entender que ambos elementos son poligonales y que los centroides de manzanas no necesariamente refieren a la solución contenida dentro de un poligono mayor.</p>
</blockquote>
<blockquote class="blockquote">
<p>Por eso es necesario usar el criterio de maxima área de la sobreposición de poligonos. Al hablar de área el sistema de proyección debe estar en metros, por lo que si no lo esta se debe cambiar. Para este caso se cambio a <a href="https://epsg.io/6362">EPSG:6362</a></p>
</blockquote>
<blockquote class="blockquote">
<p>Se cargan las colonias y se valida que ambos crs se encuentren en metros “6362 o 6362” , en caso contrario es necesrio llevar a cabo una reproyección.</p>
</blockquote>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>COLONIAS_CDMX <span class="op">=</span> gpd.read_file(Entradas <span class="op">+</span><span class="st">'COLONIAS.json'</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Colonias CRS"</span>, COLONIAS_CDMX.crs)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Manzanas CRS"</span>, MERGE.crs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Colonias CRS epsg:4326
Manzanas CRS epsg:4326</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Los archivos estan en coordenadas geograficas, por lo que se reproyecta</p>
</blockquote>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>MANZANA_METROS <span class="op">=</span> MERGE.to_crs(<span class="dv">6362</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>COLONIAS_METROS <span class="op">=</span> COLONIAS_CDMX.to_crs(<span class="dv">6362</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Crs Manzanas"</span>, MANZANA_METROS.crs )</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Crs Colonias"</span>, COLONIAS_METROS.crs )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Crs Manzanas epsg:6362
Crs Colonias epsg:6362</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Buscamos en este punto identificar la intersección entre colonias y manzanas para asignar a cada manzana (base al criterio de área maxima) la clave de la colonia a la que pertence.</p>
</blockquote>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>INTERSECCION <span class="op">=</span> gpd.overlay(COLONIAS_METROS,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                           MANZANA_METROS,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                            how <span class="op">=</span> <span class="st">'intersection'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Se calcula el valor de área para cada poligono intersectado</p>
</blockquote>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Se calcula el area </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>INTERSECCION[<span class="st">'area'</span>] <span class="op">=</span> INTERSECCION.geometry.area</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Para el overlay se reordena la información del área de manera descendente y se eliminan los duplicados con base a la “CVEGEO” manteniendo unicamente el primer valor</p>
</blockquote>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>INTERSECCION <span class="op">=</span> (INTERSECCION.sort_values(<span class="st">'area'</span>, ascending <span class="op">=</span> <span class="va">False</span>).</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                drop_duplicates(subset<span class="op">=</span><span class="st">"CVEGEO"</span>, keep <span class="op">=</span> <span class="st">'first'</span>).</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                drop([<span class="st">'geometry'</span>,<span class="st">'area'</span>], axis <span class="op">=</span> <span class="dv">1</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">### Se eliminan columnas no necesarias</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>INTERSECCION_USE <span class="op">=</span> INTERSECCION.drop([<span class="st">'ENT'</span>, <span class="st">'CVEDT'</span>, <span class="st">'NOMDT'</span>, <span class="st">'DTTOLOC'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>En la base de colonias se identificaron caracteres especiales, por lo que se procede a remplazarlos, por su valor correspondiente.</p>
</blockquote>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Dic_Ca <span class="op">=</span> {<span class="st">'Ã‘'</span>: <span class="st">'Ñ'</span>}</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>INTERSECCION_USE.replace(Dic_Ca, inplace<span class="op">=</span><span class="va">True</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>INTERSECCION_USE.columns <span class="op">=</span> INTERSECCION_USE.columns.to_series().replace(Dic_Ca, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>INTERSECCION_USE.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>(66353, 17)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Se une la información de overly de las Manzanas ya alineadas con colonias en la geometry de las manzanas para tener la base final. En la base final podemos observar la información a nivel: manzana, colonia y alcaldia, donde esta ultima se extraer en razon directa de la informacion contenida en la base de manzanas.</p>
</blockquote>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>DATA_FINAL_USE <span class="op">=</span> MANZA_CDMX.merge(INTERSECCION_USE,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                          left_on <span class="op">=</span> <span class="st">'CVEGEO'</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                          right_on <span class="op">=</span> <span class="st">'CVEGEO'</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                          how <span class="op">=</span> <span class="st">'inner'</span>).rename({<span class="st">"CVEUT"</span>: <span class="st">"CVE_COL"</span>, <span class="st">"NOMUT"</span>: <span class="st">"NOM_COL"</span>, <span class="st">"ID"</span>: <span class="st">"ID_COL"</span>}, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>DATA_FINAL_USE.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(66353, 18)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Se valida que cada manzana este asociada a cada una de las colonias<br>
Recorndado que la relación es una colonia a muchas manzanzanas<br>
“” Por lo que no deben existir manzanas repetididas”</p>
</blockquote>
<p><span class="math display">\[M_{n-1} = f(C)\]</span> <span class="math display">\[ C \gets M_{n-1}\]</span></p>
<blockquote class="blockquote">
<p>Se valida que no existan manzanas repetidas</p>
</blockquote>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>DATA_FINAL_USE.CVEGEO.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>La relacion de muchas manzanas a una colonia, se valida para cada clave de colonias se repite tantas veces existan manzanas</p>
</blockquote>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>DATA_FINAL_USE.CVE_COL.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>07-320    471
07-263    370
17-078    297
17-076    213
11-057    213
         ... 
04-005      1
10-202      1
10-206      1
10-051      1
10-007      1
Name: CVE_COL, Length: 1797, dtype: int64</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Aqui validamos como las claves de las manzanas son diferentes para una misma colonia y se entiende la relacion, muchas manzanas a una colonia</p>
</blockquote>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>DATA_FINAL_USE.query(<span class="st">'CVE_COL == "07-320"'</span>).head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVEGEO</th>
      <th>geometry</th>
      <th>CVE_COL</th>
      <th>NOM_COL</th>
      <th>ID_COL</th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>AGEB</th>
      <th>MZA</th>
      <th>POBTOT</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>P_15A24_M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>51265</th>
      <td>0900700014594012</td>
      <td>POLYGON ((-99.05630 19.37395, -99.05642 19.373...</td>
      <td>07-320</td>
      <td>CHINAMPAC DE JUAREZ III</td>
      <td>793</td>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>007</td>
      <td>Iztapalapa</td>
      <td>0001</td>
      <td>Iztapalapa</td>
      <td>4594</td>
      <td>012</td>
      <td>36.0</td>
      <td>9.0</td>
      <td>2.77</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>51303</th>
      <td>0900700014645010</td>
      <td>POLYGON ((-99.05146 19.37286, -99.05154 19.372...</td>
      <td>07-320</td>
      <td>CHINAMPAC DE JUAREZ III</td>
      <td>793</td>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>007</td>
      <td>Iztapalapa</td>
      <td>0001</td>
      <td>Iztapalapa</td>
      <td>4645</td>
      <td>010</td>
      <td>23.0</td>
      <td>10.0</td>
      <td>2.88</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>51304</th>
      <td>0900700014611041</td>
      <td>POLYGON ((-99.05389 19.37262, -99.05333 19.374...</td>
      <td>07-320</td>
      <td>CHINAMPAC DE JUAREZ III</td>
      <td>793</td>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>007</td>
      <td>Iztapalapa</td>
      <td>0001</td>
      <td>Iztapalapa</td>
      <td>4611</td>
      <td>041</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Reordenamos la información de la forma “Regional a local” es decir:</p>
</blockquote>
<p><span class="math display">\[ Alcaldia \to Colonia \to Manzana \]</span></p>
<ol type="1">
<li><strong>Alcaldia</strong>: <em>ENTIDAD, NOM_ENT, MUN, NOM_MUN, LOC, NOM_LOC,</em><br>
</li>
<li><strong>Colonia</strong>: <em>ID_COL, CVE_COL, NOM_COL,</em></li>
<li><strong>Manzana</strong>: <em>AGEB, MZA, CVEGEO,</em></li>
<li><strong>Dimensiones</strong>: <em>POBTOT, PSINDER, PROM_OCUP, P3YM_HLI, P_15A24_M</em></li>
<li><strong>Geometry</strong></li>
</ol>
<blockquote class="blockquote">
<p>Reordenamiento de la información</p>
</blockquote>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>DATA_FIN_USE <span class="op">=</span> DATA_FINAL_USE[[<span class="st">'ENTIDAD'</span>,<span class="st">'NOM_ENT'</span>, <span class="st">'MUN'</span>, <span class="st">'NOM_MUN'</span>, <span class="st">'LOC'</span>, <span class="st">'NOM_LOC'</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'ID_COL'</span>,<span class="st">'CVE_COL'</span>, <span class="st">'NOM_COL'</span>, <span class="st">'AGEB'</span>, <span class="st">'MZA'</span>, <span class="st">'CVEGEO'</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'POBTOT'</span>, <span class="st">'PSINDER'</span>, <span class="st">'PROM_OCUP'</span>, <span class="st">'P3YM_HLI'</span>, <span class="st">'P_15A24_M'</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'geometry'</span>]]</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>DATA_FIN_USE.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>ID_COL</th>
      <th>CVE_COL</th>
      <th>NOM_COL</th>
      <th>AGEB</th>
      <th>MZA</th>
      <th>CVEGEO</th>
      <th>POBTOT</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>P_15A24_M</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>031</td>
      <td>0901000010898031</td>
      <td>93.0</td>
      <td>16.0</td>
      <td>4.04</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>POLYGON ((-99.22982 19.35939, -99.23006 19.359...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1716</td>
      <td>10-143</td>
      <td>LOMAS DE TARANGO</td>
      <td>2269</td>
      <td>024</td>
      <td>0901000012269024</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>POLYGON ((-99.21840 19.36539, -99.21848 19.365...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1652</td>
      <td>10-082</td>
      <td>GRAL A ROSALES</td>
      <td>1472</td>
      <td>068</td>
      <td>0901000011472068</td>
      <td>124.0</td>
      <td>22.0</td>
      <td>3.76</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>POLYGON ((-99.24577 19.37776, -99.24576 19.377...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="análisis-de-componentes-principales-pca" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="análisis-de-componentes-principales-pca"><span class="header-section-number">4.1.1</span> Análisis de Componentes Principales (PCA)</h3>
<blockquote class="blockquote">
<p>En esta sección se cálcula el indice de <strong><em>Concetración de desventajas</em></strong> mediante la reducción de las dimensiónes por componentes principales (PCA). Esto se hace a nivel <strong>Alcaldias y Delegaciones</strong>. La información a nivel alcaldia y delegacion es un proceso de reagrupacion y nuevos calculos de los valores.</p>
</blockquote>
</section>
<section id="nivel-colonias" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="nivel-colonias"><span class="header-section-number">4.1.2</span> Nivel Colonias</h3>
<blockquote class="blockquote">
<p>Para este punto agrupamos los datos por nivel colonia para extraer el valor del índice por “PCA”</p>
</blockquote>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>COLONIA_PCA <span class="op">=</span> pd.DataFrame(DATA_FIN_USE.groupby([<span class="st">'CVE_COL'</span>]).agg({<span class="st">'POBTOT'</span>: <span class="st">'sum'</span>, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'PSINDER'</span>:<span class="st">'sum'</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'PROM_OCUP'</span>: <span class="st">'mean'</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'P3YM_HLI'</span>:<span class="st">'sum'</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'P_15A24_M'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>COLONIA_PCA.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVE_COL</th>
      <th>POBTOT</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>P_15A24_M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02-001</td>
      <td>1957.0</td>
      <td>496.0</td>
      <td>2.907000</td>
      <td>7.0</td>
      <td>138.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-002</td>
      <td>3670.0</td>
      <td>813.0</td>
      <td>3.282381</td>
      <td>43.0</td>
      <td>219.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Impotante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Para que componentes principales tenga un alto rendimiento la información sdebe estar normalizada por <strong>Z-SCORE (StandardScaler)</strong></p>
<p><span class="math display">\[ Z = \frac{x - \mu}{\sigma} \]</span></p>
</div>
</div>
<blockquote class="blockquote">
<p>Para calcular la componente principal, separamos nuestra base de datos con el fin de tener las dimensiones que contruyen el índice.</p>
</blockquote>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Hacemos un copia por si necesitamos un proceso con la base original</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>PCA_COLONIAS <span class="op">=</span> COLONIA_PCA.copy()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">### Seleccion de las dimensiones con las que se calcula el indice de desventajas "PSINDER; PROM_OCUP; P3YM_HLI; P_15A24_M"</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>PCA_X <span class="op">=</span> PCA_COLONIAS.drop([<span class="st">'CVE_COL'</span>,<span class="st">'POBTOT'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>PCA_y <span class="op">=</span> PCA_COLONIAS[[<span class="st">'CVE_COL'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Se normaliza la informacion por Z-Score, determinamos el número de componentes y aplicamos la función para calcular</p>
</blockquote>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Se normaliza la informacion por Z-Score</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>S_TRANSF <span class="op">=</span> StandardScaler()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>PCA_X_SCALER <span class="op">=</span> pd.DataFrame(S_TRANSF.fit_transform(PCA_X), </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                            columns <span class="op">=</span> PCA_X.columns)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">### Se determina el número de componentes</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>PCA_N <span class="op">=</span> PCA(n_components <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>PCA_COMPONENTE <span class="op">=</span> PCA_N.fit_transform(PCA_X_SCALER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Se calcula la varianza total por respecto al numero de componentes</p>
</blockquote>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Se calcula la varianza total por respecto al numero de componentes</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>VARIANZA_TOTA <span class="op">=</span> PCA_N.explained_variance_ratio_.<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Total de la variancia explicada </span><span class="ch">\n</span><span class="st">"</span>, <span class="bu">round</span>(VARIANZA_TOTA,<span class="dv">3</span>), <span class="st">"%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 66.816 %</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Con una componente (PC1) se explica 66.82 % de la varianza total, lo cual implica que mas de la mitad de la información e los datos puede encapsularse en ese componente principal.</p>
</blockquote>
<blockquote class="blockquote">
<p>finalmente se indexan los resultados a la base de datos como una nueva columna con clave DIS_COL = concentrated disadvantage component</p>
</blockquote>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Pegamos los valores de PCA en la base de datos</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>PCA_COLONIAS[<span class="st">'DIS_COL'</span>] <span class="op">=</span> PCA_COMPONENTE</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>PCA_COLONIAS.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVE_COL</th>
      <th>POBTOT</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>P_15A24_M</th>
      <th>DIS_COL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02-001</td>
      <td>1957.0</td>
      <td>496.0</td>
      <td>2.907000</td>
      <td>7.0</td>
      <td>138.0</td>
      <td>-1.121714</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-002</td>
      <td>3670.0</td>
      <td>813.0</td>
      <td>3.282381</td>
      <td>43.0</td>
      <td>219.0</td>
      <td>-0.533961</td>
    </tr>
    <tr>
      <th>2</th>
      <td>02-003</td>
      <td>1830.0</td>
      <td>318.0</td>
      <td>2.853333</td>
      <td>15.0</td>
      <td>122.0</td>
      <td>-1.193403</td>
    </tr>
    <tr>
      <th>3</th>
      <td>02-005</td>
      <td>2330.0</td>
      <td>497.0</td>
      <td>2.734615</td>
      <td>7.0</td>
      <td>132.0</td>
      <td>-1.175400</td>
    </tr>
    <tr>
      <th>4</th>
      <td>02-006</td>
      <td>4306.0</td>
      <td>855.0</td>
      <td>3.022222</td>
      <td>37.0</td>
      <td>310.0</td>
      <td>-0.459954</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Impotante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Lo anterior lo transformamos a una funcion para optimizar el proceso de trabajo. Funcion que podemos llamar despues</p>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> CONC_DIS (TABLA, DIM_CLAVE, DIM_POBLA):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    PCA_TABLA <span class="op">=</span> TABLA.copy()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">### Seleccion de las dimensiones con las que se calcula el indice de desventajas "PSINDER; PROM_OCUP; P3YM_HLI; P_15A24_M"</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    PCA_X <span class="op">=</span> PCA_TABLA.drop([DIM_CLAVE, DIM_POBLA], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    PCA_y <span class="op">=</span> PCA_TABLA[[DIM_CLAVE]]</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">### Se normaliza la informacion por Z-Score</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    S_TRANSF <span class="op">=</span> StandardScaler()</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    PCA_X_SCALER <span class="op">=</span> pd.DataFrame( S_TRANSF.fit_transform(PCA_X), </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>                                 columns <span class="op">=</span> PCA_X.columns)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>                                 </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">### Se determina el número de componentes</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    PCA_N <span class="op">=</span> PCA(n_components <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    PCA_COMPONENTE <span class="op">=</span> PCA_N.fit_transform(PCA_X_SCALER)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">### Se calcula la varianza total por respecto al numero de componentes</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    VARIANZA_TOTA <span class="op">=</span> PCA_N.explained_variance_ratio_.<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Total de la variancia explicada </span><span class="ch">\n</span><span class="st">"</span>, <span class="bu">round</span>(VARIANZA_TOTA,<span class="dv">3</span>), <span class="st">"%"</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">### Se indexan los resultados a la base de datos como una nueva columna con clave DIS_COL = concentrated disadvantage component </span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    PCA_TABLA[<span class="st">'DISAD'</span>] <span class="op">=</span> PCA_COMPONENTE</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    PCA_TABLA <span class="op">=</span> PCA_TABLA[[DIM_CLAVE, <span class="st">'DISAD'</span> ]]</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (PCA_TABLA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Podemos usar la función creada y aplicarla en los datos para revalidar los resultados.</p>
</blockquote>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Revalidación de información</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>DESVE_COL <span class="op">=</span> CONC_DIS (COLONIA_PCA, <span class="st">'CVE_COL'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>DESVE_COL.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 66.816 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVE_COL</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02-001</td>
      <td>-1.121714</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-002</td>
      <td>-0.533961</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="nivel-alcaldias" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="nivel-alcaldias"><span class="header-section-number">4.1.3</span> Nivel Alcaldias</h3>
<blockquote class="blockquote">
<p>El Agrupamiento de datos por nivel Alcaldia para “PCA”. Recordando que la clave de Alcaldia == Municipio la podemos observar de la forma: DATA_FIN_USE.NOM_MUN.value_counts()</p>
</blockquote>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ALCALDIA_PCA <span class="op">=</span> pd.DataFrame(DATA_FIN_USE.groupby([<span class="st">'MUN'</span>]).agg({<span class="st">'POBTOT'</span>: <span class="st">'sum'</span>, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'PSINDER'</span>:<span class="st">'sum'</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'PROM_OCUP'</span>: <span class="st">'mean'</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'P3YM_HLI'</span>:<span class="st">'sum'</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'P_15A24_M'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>ALCALDIA_PCA.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>POBTOT</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>P_15A24_M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>432205.0</td>
      <td>90063.0</td>
      <td>3.005215</td>
      <td>2139.0</td>
      <td>27478.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>614447.0</td>
      <td>160637.0</td>
      <td>2.866638</td>
      <td>6103.0</td>
      <td>39714.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Aplicamos la funcion creada con anterioridad</p>
</blockquote>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Aplicando la función creada arriba</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>DESVE_ALCA <span class="op">=</span> CONC_DIS (ALCALDIA_PCA, <span class="st">'MUN'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>DESVE_ALCA.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 74.241 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>-0.996294</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>-0.069455</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>En este punto, podemos unir toda la información a la tabla original y renombramos las columnas de desventajas en cada nivel</p>
</blockquote>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>MERGE_DESVENTAJAS <span class="op">=</span> DATA_FIN_USE.merge(DESVE_COL, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                                       left_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                       right_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                                       how <span class="op">=</span> <span class="st">'inner'</span>).merge(DESVE_ALCA, </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                                                            left_on <span class="op">=</span><span class="st">'MUN'</span>, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                                                            right_on <span class="op">=</span> <span class="st">'MUN'</span> , </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                                                            how <span class="op">=</span> <span class="st">'inner'</span>).rename({<span class="st">"DISAD_x"</span>: <span class="st">"DIS_COL"</span>, <span class="st">"DISAD_y"</span>: <span class="st">"DIS_MUN"</span>}, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>MERGE_DESVENTAJAS.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>ID_COL</th>
      <th>CVE_COL</th>
      <th>NOM_COL</th>
      <th>AGEB</th>
      <th>MZA</th>
      <th>CVEGEO</th>
      <th>POBTOT</th>
      <th>PSINDER</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>P_15A24_M</th>
      <th>geometry</th>
      <th>DIS_COL</th>
      <th>DIS_MUN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>031</td>
      <td>0901000010898031</td>
      <td>93.0</td>
      <td>16.0</td>
      <td>4.04</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>POLYGON ((-99.22982 19.35939, -99.23006 19.359...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
    </tr>
    <tr>
      <th>1</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0900</td>
      <td>019</td>
      <td>0901000010900019</td>
      <td>101.0</td>
      <td>46.0</td>
      <td>4.39</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>POLYGON ((-99.23003 19.35814, -99.23091 19.357...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Hacemos un mapita nuevamente</p>
</blockquote>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> MERGE_DESVENTAJAS.plot(ax <span class="op">=</span> ax, column<span class="op">=</span><span class="st">'DIS_COL'</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                            legend<span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                            alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                            scheme<span class="op">=</span><span class="st">'NaturalBreaks'</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                            cmap<span class="op">=</span><span class="st">'copper'</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                            classification_kwds<span class="op">=</span>{<span class="st">'k'</span>:<span class="dv">6</span>})</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'Desventajas a nivel Colonia, Ciudad de México'</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>ax.set_axis_off()</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data_files/figure-html/cell-34-output-1.png" width="504" height="632"></p>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> MERGE_DESVENTAJAS.plot(ax <span class="op">=</span> ax, column<span class="op">=</span><span class="st">'DIS_MUN'</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                            legend<span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                            alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                            scheme<span class="op">=</span><span class="st">'NaturalBreaks'</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                            cmap<span class="op">=</span><span class="st">'copper'</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                            classification_kwds<span class="op">=</span>{<span class="st">'k'</span>:<span class="dv">6</span>})</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'Desventajas a nivel Alcaldias, Ciudad de México'</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>ax.set_axis_off()</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data_files/figure-html/cell-35-output-1.png" width="504" height="632"></p>
</div>
</div>
</section>
</section>
</section>
<section id="desorden-social-y-físico" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Desorden Social y Físico</h1>
<blockquote class="blockquote">
<p>En esta seccion se usaran las llamadas del 911 para crear los índices de desorden social y desorden fisico comprendidas en dos semestres, para este caso se han usado las llamadas del primer y segundo semestre del 2021.</p>
</blockquote>
<blockquote class="blockquote">
<p>Las dimensiones que se han de usar son las siguientes</p>
</blockquote>
<div class="cell" data-execution_count="35">
<div class="cell-output cell-output-display" data-execution_count="34">
<table class="table table-sm table-striped">
<caption>Desorden Social </caption>
<thead>
<tr class="header">
<th style="text-align: left;">Clave</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intoxicación pública con drogas</td>
<td style="text-align: left;">Administrativas-Drogados</td>
</tr>
<tr class="even">
<td style="text-align: left;">Intoxicación pública con alcohol</td>
<td style="text-align: left;">Administrativas-Ebrios</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Incidencia pública</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Orinar en público</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Denuncia de persona en riesgo</td>
<td style="text-align: left;">Denuncia-Persona en Riesgo</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disturbios públicos escándalo callejero</td>
<td style="text-align: left;">Disturbio-Escándalo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Disturbios públicos fiestas ruidosas</td>
<td style="text-align: left;">Disturbio-Escándalo</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tirar basura</td>
<td style="text-align: left;">Administrativas-Tirar Basura en Vía Pública</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="cell-output cell-output-display" data-execution_count="35">
<table class="table table-sm table-striped">
<caption>Desorden Físico </caption>
<thead>
<tr class="header">
<th style="text-align: left;">Clave</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Vehículo abandonado con placas</td>
<td style="text-align: left;">Abandono-Vehículo</td>
</tr>
<tr class="even">
<td style="text-align: left;">Graffiti</td>
<td style="text-align: left;">Administrativas-Grafitis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fuga de agua potable</td>
<td style="text-align: left;">Derrame o Fuga-Agua Potable</td>
</tr>
<tr class="even">
<td style="text-align: left;">Derrame de aguas residuales</td>
<td style="text-align: left;">Derrame o Fuga-Aguas Negras</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Líneas eléctricas caídas</td>
<td style="text-align: left;">Servicios-Corto Circuito instalación o subestación eléctrica</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fugas de gas</td>
<td style="text-align: left;">Derrame o Fuga-Gas Natural</td>
</tr>
</tbody>
</table>
</div>
</div>
<blockquote class="blockquote">
<p>Se cargan las bases de datos correspondientes a los semestres del añp 2021 y se concatenan a un solo dataframe para tener todos los meses</p>
</blockquote>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Llamadas del 911 </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>LL_911_s1 <span class="op">=</span>  pd.read_csv(Entradas <span class="op">+</span> <span class="st">'llamadas_911_2021_s1.csv'</span>, encoding <span class="op">=</span> <span class="st">'Latin-1'</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>LL_911_s2 <span class="op">=</span>  pd.read_csv(Entradas <span class="op">+</span> <span class="st">'llamadas_911_2021_s2.csv'</span>, encoding <span class="op">=</span> <span class="st">'Latin-1'</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co">### Concatenaciones de semestres</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>Frame_C <span class="op">=</span> [LL_911_s1, LL_911_s2]</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>All_Data <span class="op">=</span> pd.concat(Frame_C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Validamos que se encuentren los doce meses en la columna “mes_cierre”. En este punto surgen dudas, ¿se eliminan los folios repetidos o se mantienen?</p>
</blockquote>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Validación de meses</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>All_Data.mes_cierre.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>Marzo         117554
Septiembre    113749
Abril         112352
Enero         111484
Mayo          110801
Octubre       109590
Agosto        104439
Diciembre     104276
Julio         103319
Febrero       102057
Junio          96030
Noviembre      95324
Name: mes_cierre, dtype: int64</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Con la validación de la información, seleccionamos unicamente de la dimension “incidente_c4” las clases con las que trabajaremos. De igual manera, se simplifica la descripción de las clases, se resetea el index para comenzar desde cero, seleccionamos unicamente las dimensiones que usaremos para los demas procesos (folio, categoria_incidente_c4, incidente_c4, manzana, latitud, longitud) y renombramos los campos necesarios.</p>
</blockquote>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Seleeción los valores de la dimension como una lista</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>Lista <span class="op">=</span> [<span class="st">"Drogados"</span>, <span class="st">"Ebrios"</span> , <span class="st">"Persona en riesgo"</span>, <span class="st">"Escandalo"</span>, <span class="st">"Fiestas"</span> , <span class="st">"Tirar basura en via publica"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Vehiculo"</span>, <span class="st">"Grafitis"</span>, <span class="st">"Agua potable"</span>, <span class="st">"Aguas negras"</span>, <span class="st">"Corto circuito instalacion o subestacion electrica"</span>, <span class="st">"Fuga de gas natural"</span>]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>All_Data_filtered <span class="op">=</span> All_Data[All_Data[<span class="st">'incidente_c4'</span>].isin(Lista)]</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>All_Data_filtered <span class="op">=</span> All_Data_filtered.replace({<span class="st">'Fiestas'</span>:<span class="st">'FIESTA'</span>,<span class="st">'Escandalo'</span>:<span class="st">'ESCANDALO'</span>,<span class="st">'Ebrios'</span>:<span class="st">'EBRIO'</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Agua potable'</span>:<span class="st">'AGUA_P'</span>,<span class="st">'Drogados'</span>:<span class="st">'DROGADO'</span>,<span class="st">'Vehiculo'</span>:<span class="st">'VEHICULO'</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Grafitis'</span>:<span class="st">'GRAFITI'</span>,<span class="st">'Persona en riesgo'</span>:<span class="st">'PERSO_R'</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Aguas negras'</span>:<span class="st">'AGUA_N'</span>, <span class="st">'Tirar basura en via publica'</span>:<span class="st">'BASURA_P'</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Corto circuito instalacion o subestacion electrica'</span>:<span class="st">'CORTO_ELE'</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">'Fuga de gas natural'</span>:<span class="st">'FUGAS_N'</span>}).reset_index(drop <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>All_Data_filtered <span class="op">=</span> All_Data_filtered[[<span class="st">"folio"</span>,<span class="st">"categoria_incidente_c4"</span>,<span class="st">"incidente_c4"</span>, </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"manzana"</span>,<span class="st">"latitud"</span>,<span class="st">"longitud"</span>]].rename({<span class="st">"categoria_incidente_c4"</span>: <span class="st">"Categoria"</span>,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>                                                                                <span class="st">"incidente_c4"</span>: <span class="st">"Incidente"</span>}, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="el-jardín-de-las-bifurcaciones" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="el-jardín-de-las-bifurcaciones"><span class="header-section-number">5.1</span> El jardín de las bifurcaciones</h2>
<blockquote class="blockquote">
<p>En esta seccion usaremos para calcular los valores de desorden social y fisico, usaremos dos formas: las claves de las manzanas y las coordenadas geograficas a fin de comparar resultados.</p>
</blockquote>
<section id="corrección-columna-clave-de-manzana" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="corrección-columna-clave-de-manzana"><span class="header-section-number">5.1.1</span> Corrección columna clave de manzana</h3>
<blockquote class="blockquote">
<p>Inicialmente notamos de nuestra base de datos las columnas manzana, longitud y latitud. Para la primer bifurcación usaremos las claves de manzanas que se encuentran asignadas. Al hacer esto nos damos cuenta que necesitamos una limpieza de datos. Lo anterior por:</p>
</blockquote>
<ol type="1">
<li>El tipo de dato es string esta en su forma es cientifico,</li>
<li>Tenemos que transformar los string a numeros aplicando la funcion “to_numeric”</li>
<li>Se extiende el numero de su forma cientifica a su forma natural</li>
<li>Los elementos con caracteres alfanumericos se asignan como “NAN”.</li>
</ol>
<blockquote class="blockquote">
<p>En este punto podemos notar que ya tenemos el string cientifico en “float”, lo que tenemos que hacer es extraer el numero sin notación cientifica, para eso aplicamos una funcion “lamnda” que convierta el float en string sin notación cientifica y los “nan_text” sean remplazamos por “NAN” verdaderos.</p>
</blockquote>
<div class="callout-important callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Impotante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Recordar que las claves comienzan con un cero y que el total de caracteres para manzanas son 16.</p>
<p>CVEGEO = “0900700000000000”</p>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Transformación de string to float </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>Manza_Num <span class="op">=</span> pd.DataFrame(pd.to_numeric(All_Data_filtered[<span class="st">'manzana'</span>], errors <span class="op">=</span> <span class="st">'coerce'</span>))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Se extiende el numero a su forma natural</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>Manza_Num <span class="op">=</span> pd.DataFrame(Manza_Num[<span class="st">'manzana'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">'%.0f'</span> <span class="op">%</span>x)).replace(<span class="st">'nan'</span>, np.nan)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">### Recordando que las claves comienzan con un cero y que para manzanas es un total de 16 caracteres</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">### Asignamos el cero</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>Manza_Num[<span class="st">'manzana'</span>] <span class="op">=</span> Manza_Num[<span class="st">'manzana'</span>].<span class="bu">str</span>.zfill(<span class="dv">16</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>Manza_Num.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>(301784, 1)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Ya tenemos un dataframe con las claves en string y los indices como campo llave primaria con NAN verdaderos</p>
</blockquote>
<blockquote class="blockquote">
<p>Ahora vamos a hacer una union entre estos resultados y los el dataframe filtrado (All_Data_filtered) con base a su indice. Al ser un merge por indices, es recomendable que este este reiniciado (por lo que se entiende la necesidad de su reinicio en procesos anteriores).</p>
</blockquote>
<blockquote class="blockquote">
<p>De la union tendremos dos columnas con claves manzanas, las cuales las usaremos en una función para asignnación de clave corregida</p>
</blockquote>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Union entre tablas</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>USO_MANZAS <span class="op">=</span> All_Data_filtered.merge(Manza_Num,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                                     left_index <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                                     right_index <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>USO_MANZAS.head(<span class="dv">3</span>)                                   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>folio</th>
      <th>Categoria</th>
      <th>Incidente</th>
      <th>manzana_x</th>
      <th>latitud</th>
      <th>longitud</th>
      <th>manzana_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C5/210101/00770</td>
      <td>Disturbio</td>
      <td>FIESTA</td>
      <td>9.007E+14</td>
      <td>19.368088</td>
      <td>-99.132832</td>
      <td>0900700000000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C5/210101/01333</td>
      <td>Disturbio</td>
      <td>FIESTA</td>
      <td>9.007E+14</td>
      <td>19.354583</td>
      <td>-99.061529</td>
      <td>0900700000000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C5/210101/01973</td>
      <td>Disturbio</td>
      <td>FIESTA</td>
      <td>9.003E+14</td>
      <td>19.332512</td>
      <td>-99.175247</td>
      <td>0900300000000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>La <strong>asignacion de clave correcta:</strong> se lleva a cabo considerando las combianciones de resultados posibles entre las dos columnas de nombre manzanas (x,y). De lo anterior se obtienen las siguientes reglas de negocios:</p>
</blockquote>
<ol type="1">
<li>Si manzana_x == manzana_x &amp; manzana_y == manzana_y, entonces el valor sera manzana_y</li>
<li>Si manzana_x == manzana_x &amp; manzana_y != manzana_y, entonces el valor sera manzana_x</li>
<li>Si ninguno de los dos anteriores se cumple se asigna NAN</li>
</ol>
<blockquote class="blockquote">
<p>Con base a las reglas se configura la función:</p>
</blockquote>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Creamos una función</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> manzan_a(C):</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ((C.manzana_x <span class="op">==</span> C.manzana_x) <span class="op">&amp;</span> (C.manzana_y <span class="op">==</span> C.manzana_y)):</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> C.manzana_y</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ((C.manzana_x <span class="op">==</span> C.manzana_x) <span class="op">&amp;</span> (C.manzana_y <span class="op">!=</span> C.manzana_y)):</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> C.manzana_x</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Se aplica la funcion y se eliminan las dimensiones no necesarias</p>
</blockquote>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Aplicamos la función</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>USO_MANZAS[<span class="st">'CVEGEO'</span>] <span class="op">=</span> USO_MANZAS.<span class="bu">apply</span>(manzan_a, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Eliminamos las dimensiones no necesarias y tenemos la tabla de inicio</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>USO_MANZAS <span class="op">=</span> USO_MANZAS.drop([<span class="st">'manzana_x'</span>, <span class="st">'manzana_y'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>USO_MANZAS.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>folio</th>
      <th>Categoria</th>
      <th>Incidente</th>
      <th>latitud</th>
      <th>longitud</th>
      <th>CVEGEO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C5/210101/00770</td>
      <td>Disturbio</td>
      <td>FIESTA</td>
      <td>19.368088</td>
      <td>-99.132832</td>
      <td>0900700000000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C5/210101/01333</td>
      <td>Disturbio</td>
      <td>FIESTA</td>
      <td>19.354583</td>
      <td>-99.061529</td>
      <td>0900700000000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C5/210101/01973</td>
      <td>Disturbio</td>
      <td>FIESTA</td>
      <td>19.332512</td>
      <td>-99.175247</td>
      <td>0900300000000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="caso-por-mananzas-y-clave-manzanas" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="caso-por-mananzas-y-clave-manzanas"><span class="header-section-number">5.1.2</span> <strong>Caso por Mananzas y Clave Manzanas</strong></h3>
<blockquote class="blockquote">
<p>Para este caso, vamos a contar cuantos eventos de una determinada clase en el tipo de incidentes estan inmersos en las manzanas. Para la forma con columna y claves manzanas, seleccionamos unicamente las columnas de trabajo, en este caso se eliminan longitud y latitud.</p>
</blockquote>
<blockquote class="blockquote">
<p>Para contabilizar las clases en la columna haremos uso de un dataframe dummy</p>
</blockquote>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Se eliminan columnas no necesarias</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>USO_MANZAS_TRUE <span class="op">=</span> USO_MANZAS.drop([<span class="st">'latitud'</span>,<span class="st">'longitud'</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">### Para contabilizar, notamos que la descripcion del incidente esta en fila,</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">### por lo que tenemos que crear un dataframe dummy</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>USO_MANZAS_TRUE_DMY <span class="op">=</span> pd.get_dummies(USO_MANZAS_TRUE, </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                                     columns<span class="op">=</span>[<span class="st">"Incidente"</span>], </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>                                     prefix<span class="op">=</span>[<span class="st">"DM"</span>])</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>USO_MANZAS_TRUE_DMY.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>folio</th>
      <th>Categoria</th>
      <th>CVEGEO</th>
      <th>DM_AGUA_N</th>
      <th>DM_AGUA_P</th>
      <th>DM_BASURA_P</th>
      <th>DM_CORTO_ELE</th>
      <th>DM_DROGADO</th>
      <th>DM_EBRIO</th>
      <th>DM_ESCANDALO</th>
      <th>DM_FIESTA</th>
      <th>DM_FUGAS_N</th>
      <th>DM_GRAFITI</th>
      <th>DM_PERSO_R</th>
      <th>DM_VEHICULO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C5/210101/00770</td>
      <td>Disturbio</td>
      <td>0900700000000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C5/210101/01333</td>
      <td>Disturbio</td>
      <td>0900700000000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C5/210101/01973</td>
      <td>Disturbio</td>
      <td>0900300000000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Ahora que tenemos nuestro dataframe dummy podemos contar, para lograr eso, tenemos que agrupar y sumar los eventos</p>
</blockquote>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Agrupación de dataframe Dummy</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>MANZANA_DUMMMY <span class="op">=</span> pd.DataFrame(USO_MANZAS_TRUE_DMY.groupby([<span class="st">'CVEGEO'</span>]).agg({<span class="st">'DM_AGUA_N'</span>: <span class="st">'sum'</span>, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_AGUA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_BASURA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_CORTO_ELE'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_DROGADO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_EBRIO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_ESCANDALO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_FIESTA'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_FUGAS_N'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_GRAFITI'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_PERSO_R'</span>: <span class="st">'sum'</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_VEHICULO'</span>: <span class="st">'sum'</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>                                                                          }).reset_index())</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>MANZANA_DUMMMY.head(<span class="dv">3</span>)                                                           </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVEGEO</th>
      <th>DM_AGUA_N</th>
      <th>DM_AGUA_P</th>
      <th>DM_BASURA_P</th>
      <th>DM_CORTO_ELE</th>
      <th>DM_DROGADO</th>
      <th>DM_EBRIO</th>
      <th>DM_ESCANDALO</th>
      <th>DM_FIESTA</th>
      <th>DM_FUGAS_N</th>
      <th>DM_GRAFITI</th>
      <th>DM_PERSO_R</th>
      <th>DM_VEHICULO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0900000000000000</td>
      <td>202.0</td>
      <td>1684.0</td>
      <td>190.0</td>
      <td>4</td>
      <td>1660.0</td>
      <td>9917.0</td>
      <td>8109.0</td>
      <td>5349.0</td>
      <td>11</td>
      <td>94.0</td>
      <td>439.0</td>
      <td>971.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0900200000000000</td>
      <td>4.0</td>
      <td>102.0</td>
      <td>8.0</td>
      <td>0</td>
      <td>170.0</td>
      <td>841.0</td>
      <td>994.0</td>
      <td>1353.0</td>
      <td>0</td>
      <td>7.0</td>
      <td>15.0</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>090020001003A003</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Ahora haremos oitra union y seleccionaremos aquellos elementos para crear el Desorden Social y fisico. Se unen la tabla DATA_FIN_USE y MANZANA_DUMMMY. Esto se hace en esa tabla porque debemos recordar que las manzanas tienen su asignacion de clave de colonias y alcaldias con base al criterio de maxima área.</p>
</blockquote>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Union de tablas </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>SOCIAL_FISICO <span class="op">=</span> DATA_FIN_USE.merge(MANZANA_DUMMMY,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                                   left_on <span class="op">=</span> <span class="st">'CVEGEO'</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                                   right_on <span class="op">=</span> <span class="st">'CVEGEO'</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                                   how <span class="op">=</span> <span class="st">'left'</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>SOCIAL_FISICO.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>ID_COL</th>
      <th>CVE_COL</th>
      <th>NOM_COL</th>
      <th>AGEB</th>
      <th>...</th>
      <th>DM_BASURA_P</th>
      <th>DM_CORTO_ELE</th>
      <th>DM_DROGADO</th>
      <th>DM_EBRIO</th>
      <th>DM_ESCANDALO</th>
      <th>DM_FIESTA</th>
      <th>DM_FUGAS_N</th>
      <th>DM_GRAFITI</th>
      <th>DM_PERSO_R</th>
      <th>DM_VEHICULO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1716</td>
      <td>10-143</td>
      <td>LOMAS DE TARANGO</td>
      <td>2269</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1652</td>
      <td>10-082</td>
      <td>GRAL A ROSALES</td>
      <td>1472</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 30 columns</p>
</div>
</div>
</div>
</section>
<section id="desorden-social-y-fisico-a-nivel-colonia" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="desorden-social-y-fisico-a-nivel-colonia"><span class="header-section-number">5.1.3</span> Desorden Social y Fisico a nivel Colonia</h3>
<blockquote class="blockquote">
<p>De la misma forma que se ejecuto codigo pasado, lo que necesitamos es el grupamiento de datos por nivel colonia para calcular la componente de Desorden Social por “PCA”</p>
</blockquote>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Agrupación de datos </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>SOCIAL_PCA <span class="op">=</span> pd.DataFrame(SOCIAL_FISICO.groupby([<span class="st">'CVE_COL'</span>]).agg({<span class="st">'POBTOT'</span>:<span class="st">'sum'</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_DROGADO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_EBRIO'</span>:<span class="st">'sum'</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_ESCANDALO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_FIESTA'</span>:<span class="st">'sum'</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_BASURA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_PERSO_R'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>SOCIAL_PCA.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVE_COL</th>
      <th>POBTOT</th>
      <th>DM_DROGADO</th>
      <th>DM_EBRIO</th>
      <th>DM_ESCANDALO</th>
      <th>DM_FIESTA</th>
      <th>DM_BASURA_P</th>
      <th>DM_PERSO_R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02-001</td>
      <td>1957.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-002</td>
      <td>3670.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p><strong>PCA DESORDEN SOCIAL</strong></p>
</blockquote>
<blockquote class="blockquote">
<p>De igual manera aplicamos la funcion creada en pasos anteriores</p>
</blockquote>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>DESORDEN_SOCIAL <span class="op">=</span> CONC_DIS(SOCIAL_PCA, <span class="st">'CVE_COL'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>DESORDEN_SOCIAL.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 61.258 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="47">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVE_COL</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02-001</td>
      <td>-0.636744</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-002</td>
      <td>-0.636744</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Ahora, con las dimensioes con las que se calcula el desorden fisico, agrupamos los datos por nivel colonia para calcular la componente por “PCA”</p>
</blockquote>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Agrupamiento de datos por nivel colonia para "PCA" DESORDEN FISICO</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>FISICO_PCA <span class="op">=</span> pd.DataFrame(SOCIAL_FISICO.groupby([<span class="st">'CVE_COL'</span>]).agg({<span class="st">'POBTOT'</span>:<span class="st">'sum'</span>,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_VEHICULO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_GRAFITI'</span>:<span class="st">'sum'</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_AGUA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_AGUA_N'</span>:<span class="st">'sum'</span>,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_CORTO_ELE'</span>: <span class="st">'sum'</span>,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">'DM_FUGAS_N'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>FISICO_PCA.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVE_COL</th>
      <th>POBTOT</th>
      <th>DM_VEHICULO</th>
      <th>DM_GRAFITI</th>
      <th>DM_AGUA_P</th>
      <th>DM_AGUA_N</th>
      <th>DM_CORTO_ELE</th>
      <th>DM_FUGAS_N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02-001</td>
      <td>1957.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-002</td>
      <td>3670.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Nuevamente, aplicamos la funcion creada en pasos anteriores</p>
</blockquote>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Aplicamos la funcion creada en pasos anteriores</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>DESORDEN_FISICO <span class="op">=</span> CONC_DIS(FISICO_PCA, <span class="st">'CVE_COL'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>DESORDEN_FISICO.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 35.943 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVE_COL</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02-001</td>
      <td>-0.443488</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-002</td>
      <td>-0.443488</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="desorden-social-y-fisico-a-nivel-alcaldia" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="desorden-social-y-fisico-a-nivel-alcaldia"><span class="header-section-number">5.1.4</span> Desorden Social y Fisico a nivel Alcaldia</h3>
<blockquote class="blockquote">
<p>El agrupamiento se hace ahora por alcaldia o Municipio para desorden social</p>
</blockquote>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Agrupamiento de datos por nivel Alcaldia para "PCA" DESORDEN SOCIAL</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>SOCIAL_ALPCA <span class="op">=</span> pd.DataFrame(SOCIAL_FISICO.groupby([<span class="st">'MUN'</span>]).agg({<span class="st">'POBTOT'</span>:<span class="st">'sum'</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">'DM_DROGADO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">'DM_EBRIO'</span>:<span class="st">'sum'</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">'DM_ESCANDALO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">'DM_FIESTA'</span>:<span class="st">'sum'</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">'DM_BASURA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                                                              <span class="st">'DM_PERSO_R'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>SOCIAL_ALCAL <span class="op">=</span> CONC_DIS(SOCIAL_ALPCA, <span class="st">'MUN'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>SOCIAL_ALCAL.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 76.681 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="50">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>-0.108228</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>1.059589</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Aplicado el agrupamiento a municipio para desorden fisico</p>
</blockquote>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Agrupamiento de datos por nivel Alcaldia para "PCA" DESORDEN FISICO</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>FISICO_ALPCA <span class="op">=</span> pd.DataFrame(SOCIAL_FISICO.groupby([<span class="st">'MUN'</span>]).agg({<span class="st">'POBTOT'</span>:<span class="st">'sum'</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'DM_VEHICULO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'DM_GRAFITI'</span>:<span class="st">'sum'</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'DM_AGUA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'DM_AGUA_N'</span>:<span class="st">'sum'</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'DM_CORTO_ELE'</span>: <span class="st">'sum'</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">'DM_FUGAS_N'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>FISICO_ALCAL <span class="op">=</span> CONC_DIS(FISICO_ALPCA, <span class="st">'MUN'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>FISICO_ALCAL.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 60.443 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="51">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>-1.863468</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>0.573604</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Ahora crearemos la base de datos finales, para eso haremos una serie de uniones con toda la información a la tabla original y renombramos las columnas de lo necesario en cada nivel.</p>
</blockquote>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>MERGE_SOCIAL <span class="op">=</span> MERGE_DESVENTAJAS.merge(DESORDEN_SOCIAL,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                                       left_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                                        right_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                                        how <span class="op">=</span> <span class="st">'inner'</span>).merge(SOCIAL_ALCAL,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                                                             left_on <span class="op">=</span><span class="st">'MUN'</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                                                             right_on <span class="op">=</span> <span class="st">'MUN'</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>                                                             how <span class="op">=</span> <span class="st">'inner'</span>).rename({<span class="st">"DISAD_x"</span>: <span class="st">"SOCIAL_COL"</span>, </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                                                                                    <span class="st">"DISAD_y"</span>: <span class="st">"SOCIAL_MUN"</span>}, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>MERGE_FISICO <span class="op">=</span> MERGE_SOCIAL.merge(DESORDEN_FISICO,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>                                  left_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>                                  right_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>                                  how <span class="op">=</span> <span class="st">'inner'</span>).merge(FISICO_ALCAL,</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>                                                       left_on <span class="op">=</span><span class="st">'MUN'</span>,</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>                                                       right_on <span class="op">=</span> <span class="st">'MUN'</span>,</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>                                                       how <span class="op">=</span> <span class="st">'inner'</span>).rename({<span class="st">"DISAD_x"</span>: <span class="st">"FISICO_COL"</span>, </span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>                                                                              <span class="st">"DISAD_y"</span>: <span class="st">"FISICO_MUN"</span>}, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>MERGE_FISICO.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>ID_COL</th>
      <th>CVE_COL</th>
      <th>NOM_COL</th>
      <th>AGEB</th>
      <th>...</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>P_15A24_M</th>
      <th>geometry</th>
      <th>DIS_COL</th>
      <th>DIS_MUN</th>
      <th>SOCIAL_COL</th>
      <th>SOCIAL_MUN</th>
      <th>FISICO_COL</th>
      <th>FISICO_MUN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>...</td>
      <td>4.04</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>POLYGON ((-99.22982 19.35939, -99.23006 19.359...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>-0.636744</td>
      <td>1.033927</td>
      <td>-0.443488</td>
      <td>0.873328</td>
    </tr>
    <tr>
      <th>1</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0900</td>
      <td>...</td>
      <td>4.39</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>POLYGON ((-99.23003 19.35814, -99.23091 19.357...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>-0.636744</td>
      <td>1.033927</td>
      <td>-0.443488</td>
      <td>0.873328</td>
    </tr>
    <tr>
      <th>2</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>...</td>
      <td>3.54</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>POLYGON ((-99.22965 19.35917, -99.22977 19.359...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>-0.636744</td>
      <td>1.033927</td>
      <td>-0.443488</td>
      <td>0.873328</td>
    </tr>
    <tr>
      <th>3</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0900</td>
      <td>...</td>
      <td>3.08</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>POLYGON ((-99.22887 19.35633, -99.22904 19.356...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>-0.636744</td>
      <td>1.033927</td>
      <td>-0.443488</td>
      <td>0.873328</td>
    </tr>
    <tr>
      <th>4</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0900</td>
      <td>...</td>
      <td>3.63</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>POLYGON ((-99.22885 19.35836, -99.22903 19.358...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>-0.636744</td>
      <td>1.033927</td>
      <td>-0.443488</td>
      <td>0.873328</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>A este punto tendremos la base como la necesitamos, solo queda reordenar para un uso mas facil</p>
</blockquote>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>DATA_SET_FINAL <span class="op">=</span> MERGE_FISICO[[<span class="st">'ENTIDAD'</span>, <span class="st">'NOM_ENT'</span>, <span class="st">'MUN'</span>, <span class="st">'NOM_MUN'</span>, <span class="st">'LOC'</span>, <span class="st">'NOM_LOC'</span>, <span class="st">'ID_COL'</span>,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'CVE_COL'</span>, <span class="st">'NOM_COL'</span>, <span class="st">'AGEB'</span>, <span class="st">'MZA'</span>, <span class="st">'CVEGEO'</span>, <span class="st">'POBTOT'</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'DIS_COL'</span>, <span class="st">'DIS_MUN'</span>, <span class="st">'SOCIAL_COL'</span>, <span class="st">'SOCIAL_MUN'</span>, <span class="st">'FISICO_COL'</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'FISICO_MUN'</span>, <span class="st">'geometry'</span>]]</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>DATA_SET_FINAL.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>ID_COL</th>
      <th>CVE_COL</th>
      <th>NOM_COL</th>
      <th>AGEB</th>
      <th>MZA</th>
      <th>CVEGEO</th>
      <th>POBTOT</th>
      <th>DIS_COL</th>
      <th>DIS_MUN</th>
      <th>SOCIAL_COL</th>
      <th>SOCIAL_MUN</th>
      <th>FISICO_COL</th>
      <th>FISICO_MUN</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>031</td>
      <td>0901000010898031</td>
      <td>93.0</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>-0.636744</td>
      <td>1.033927</td>
      <td>-0.443488</td>
      <td>0.873328</td>
      <td>POLYGON ((-99.22982 19.35939, -99.23006 19.359...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0900</td>
      <td>019</td>
      <td>0901000010900019</td>
      <td>101.0</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>-0.636744</td>
      <td>1.033927</td>
      <td>-0.443488</td>
      <td>0.873328</td>
      <td>POLYGON ((-99.23003 19.35814, -99.23091 19.357...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>023</td>
      <td>0901000010898023</td>
      <td>99.0</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>-0.636744</td>
      <td>1.033927</td>
      <td>-0.443488</td>
      <td>0.873328</td>
      <td>POLYGON ((-99.22965 19.35917, -99.22977 19.359...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Hacemos otro mapita, porque ya sabemos que nos gustan</p>
</blockquote>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> DATA_SET_FINAL.plot(ax <span class="op">=</span> ax, column<span class="op">=</span><span class="st">'FISICO_MUN'</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                            legend<span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                            alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                            scheme<span class="op">=</span><span class="st">'NaturalBreaks'</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                            cmap<span class="op">=</span><span class="st">'copper'</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                            classification_kwds<span class="op">=</span>{<span class="st">'k'</span>:<span class="dv">6</span>})</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'Desorden Fisico a nivel Alcaldia, Ciudad de México'</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>ax.set_axis_off()</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data_files/figure-html/cell-56-output-1.png" width="504" height="631"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Un ultimo paso es la validación de los resultados de esta forma con los obtenidos antes de las uniones a las manzanas, para eso agrupamos y calculamos la media de cada dimension</p>
</blockquote>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">### validamos la informacion de las dimensiones creadas</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>DATA_SET_FINAL.groupby([<span class="st">'MUN'</span>]).agg({<span class="st">'DIS_COL'</span>:<span class="st">'mean'</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'DIS_MUN'</span>: <span class="st">'mean'</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'SOCIAL_COL'</span>:<span class="st">'mean'</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'SOCIAL_MUN'</span>: <span class="st">'mean'</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'FISICO_COL'</span>:<span class="st">'mean'</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'FISICO_MUN'</span>: <span class="st">'mean'</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                                    }).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>DIS_COL</th>
      <th>DIS_MUN</th>
      <th>SOCIAL_COL</th>
      <th>SOCIAL_MUN</th>
      <th>FISICO_COL</th>
      <th>FISICO_MUN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>-0.312325</td>
      <td>-0.996294</td>
      <td>0.196748</td>
      <td>-0.108228</td>
      <td>-0.156930</td>
      <td>-1.863468</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>-0.006193</td>
      <td>-0.069455</td>
      <td>0.311090</td>
      <td>1.059589</td>
      <td>0.293600</td>
      <td>0.573604</td>
    </tr>
    <tr>
      <th>2</th>
      <td>004</td>
      <td>1.106869</td>
      <td>-1.304359</td>
      <td>0.098220</td>
      <td>-2.826147</td>
      <td>-0.103746</td>
      <td>-2.381901</td>
    </tr>
    <tr>
      <th>3</th>
      <td>005</td>
      <td>0.565336</td>
      <td>2.040898</td>
      <td>0.184904</td>
      <td>2.975016</td>
      <td>0.329208</td>
      <td>3.574120</td>
    </tr>
    <tr>
      <th>4</th>
      <td>006</td>
      <td>1.201381</td>
      <td>-0.650310</td>
      <td>0.903878</td>
      <td>0.204031</td>
      <td>0.327934</td>
      <td>-0.687370</td>
    </tr>
    <tr>
      <th>5</th>
      <td>007</td>
      <td>1.719481</td>
      <td>5.736332</td>
      <td>0.224290</td>
      <td>4.864047</td>
      <td>0.138066</td>
      <td>2.623189</td>
    </tr>
    <tr>
      <th>6</th>
      <td>008</td>
      <td>0.868157</td>
      <td>-1.099762</td>
      <td>0.329092</td>
      <td>-2.475364</td>
      <td>0.275849</td>
      <td>-1.962040</td>
    </tr>
    <tr>
      <th>7</th>
      <td>009</td>
      <td>4.909275</td>
      <td>-1.163220</td>
      <td>-0.315863</td>
      <td>-3.290602</td>
      <td>-0.179439</td>
      <td>-2.487223</td>
    </tr>
    <tr>
      <th>8</th>
      <td>010</td>
      <td>0.126637</td>
      <td>0.533438</td>
      <td>0.098015</td>
      <td>1.033927</td>
      <td>0.190218</td>
      <td>0.873328</td>
    </tr>
    <tr>
      <th>9</th>
      <td>011</td>
      <td>1.633560</td>
      <td>-0.609511</td>
      <td>0.438813</td>
      <td>-1.867119</td>
      <td>0.587161</td>
      <td>-0.548826</td>
    </tr>
    <tr>
      <th>10</th>
      <td>012</td>
      <td>0.829067</td>
      <td>0.688221</td>
      <td>0.058954</td>
      <td>-0.280469</td>
      <td>0.486348</td>
      <td>2.281060</td>
    </tr>
    <tr>
      <th>11</th>
      <td>013</td>
      <td>2.961643</td>
      <td>0.183677</td>
      <td>0.006548</td>
      <td>-2.229841</td>
      <td>0.007994</td>
      <td>-1.260814</td>
    </tr>
    <tr>
      <th>12</th>
      <td>014</td>
      <td>-0.000506</td>
      <td>-1.302296</td>
      <td>0.735603</td>
      <td>-0.326258</td>
      <td>0.350952</td>
      <td>-0.580746</td>
    </tr>
    <tr>
      <th>13</th>
      <td>015</td>
      <td>1.070981</td>
      <td>-0.151071</td>
      <td>1.250985</td>
      <td>1.979941</td>
      <td>0.810097</td>
      <td>3.063466</td>
    </tr>
    <tr>
      <th>14</th>
      <td>016</td>
      <td>-0.491578</td>
      <td>-1.227027</td>
      <td>0.644503</td>
      <td>1.155803</td>
      <td>0.207842</td>
      <td>-0.424593</td>
    </tr>
    <tr>
      <th>15</th>
      <td>017</td>
      <td>0.548961</td>
      <td>-0.609259</td>
      <td>0.788632</td>
      <td>0.131673</td>
      <td>0.413103</td>
      <td>-0.791786</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>FISICO_ALCAL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>-1.863468</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>0.573604</td>
    </tr>
    <tr>
      <th>2</th>
      <td>004</td>
      <td>-2.381901</td>
    </tr>
    <tr>
      <th>3</th>
      <td>005</td>
      <td>3.574120</td>
    </tr>
    <tr>
      <th>4</th>
      <td>006</td>
      <td>-0.687370</td>
    </tr>
    <tr>
      <th>5</th>
      <td>007</td>
      <td>2.623189</td>
    </tr>
    <tr>
      <th>6</th>
      <td>008</td>
      <td>-1.962040</td>
    </tr>
    <tr>
      <th>7</th>
      <td>009</td>
      <td>-2.487223</td>
    </tr>
    <tr>
      <th>8</th>
      <td>010</td>
      <td>0.873328</td>
    </tr>
    <tr>
      <th>9</th>
      <td>011</td>
      <td>-0.548826</td>
    </tr>
    <tr>
      <th>10</th>
      <td>012</td>
      <td>2.281060</td>
    </tr>
    <tr>
      <th>11</th>
      <td>013</td>
      <td>-1.260814</td>
    </tr>
    <tr>
      <th>12</th>
      <td>014</td>
      <td>-0.580746</td>
    </tr>
    <tr>
      <th>13</th>
      <td>015</td>
      <td>3.063466</td>
    </tr>
    <tr>
      <th>14</th>
      <td>016</td>
      <td>-0.424593</td>
    </tr>
    <tr>
      <th>15</th>
      <td>017</td>
      <td>-0.791786</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="caso-por-mananzas-y-puntos-geom" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="caso-por-mananzas-y-puntos-geom"><span class="header-section-number">5.1.5</span> <strong>Caso por Mananzas y Puntos Geom</strong></h3>
<blockquote class="blockquote">
<p>Comenzamos usando la tabla que habiamos creado con anterioridad, aquella donde se hicieron las correciones a la clave manzanada (USO_MANZAS). De la tabla se crean las geometrias las cuales necesitan tener definido un sistema de proyección.</p>
</blockquote>
<blockquote class="blockquote">
<p>Como notamos en los datos, el sistema de coordendas se encuentra en longitud / latitud, por lo que se asigna una proyeccion geografica wgs84 con epsg 4326</p>
</blockquote>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>USO_MANZAS_GDF <span class="op">=</span> gpd.GeoDataFrame(USO_MANZAS,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                                  geometry <span class="op">=</span> gpd.points_from_xy(USO_MANZAS.longitud,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                                                                USO_MANZAS.latitud), crs<span class="op">=</span><span class="dv">4326</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>USO_MANZAS_GDF.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>folio</th>
      <th>Categoria</th>
      <th>Incidente</th>
      <th>latitud</th>
      <th>longitud</th>
      <th>CVEGEO</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C5/210101/00770</td>
      <td>Disturbio</td>
      <td>FIESTA</td>
      <td>19.368088</td>
      <td>-99.132832</td>
      <td>0900700000000000</td>
      <td>POINT (-99.13283 19.36809)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C5/210101/01333</td>
      <td>Disturbio</td>
      <td>FIESTA</td>
      <td>19.354583</td>
      <td>-99.061529</td>
      <td>0900700000000000</td>
      <td>POINT (-99.06153 19.35458)</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Para una visual base, hacemos un mapa de las distribuciones espaciales de alguna de las clases de la dimension Incidente. En este caso ejemplo observamos a las personas en riesgo</p>
</blockquote>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Creación de un Mapa</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>base <span class="op">=</span> DATA_FIN_USE.plot(color <span class="op">=</span><span class="st">'grey'</span>,figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>USO_MANZAS_GDF.query(<span class="st">'Incidente == "PERSO_R"'</span>).plot(ax <span class="op">=</span> base, </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                                                    color <span class="op">=</span> <span class="st">'red'</span>, </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                                                    markersize <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>plt.title(label <span class="op">=</span> <span class="st">'Población Total, Ciudad de México'</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data_files/figure-html/cell-60-output-1.png" width="504" height="631"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Por el camino de las geometrias, lo que buscaremos es contabilizar el número de clases de geometria punto dentro de las manzanas de geometria poligonal que contienen las claves de colonias (claves asiganadas por el criterio de área maxima). Para que eso suceda, debemos hacer un join geoespacial.</p>
</blockquote>
</section>
<section id="contabilizando-los-puntos-dentro-de-poligonos" class="level3" data-number="5.1.6">
<h3 data-number="5.1.6" class="anchored" data-anchor-id="contabilizando-los-puntos-dentro-de-poligonos"><span class="header-section-number">5.1.6</span> Contabilizando los puntos dentro de poligonos</h3>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Hacemos un join geoespacial de los puntos que se encuentran contenidos dentro del poligono</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>MANZANA_911 <span class="op">=</span> gpd.sjoin(DATA_FIN_USE, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                        USO_MANZAS_GDF[[<span class="st">'folio'</span>, <span class="st">'Categoria'</span>, </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">'Incidente'</span>,<span class="st">'CVEGEO'</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">'geometry'</span>]], </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>                         how <span class="op">=</span> <span class="st">"inner"</span>, </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>                         op <span class="op">=</span> <span class="st">'contains'</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>MANZANA_911.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>(291004, 23)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Veamos que sucede con la información y sus relaciones, para esto consideramos dos casos:</p>
</blockquote>
<ol type="1">
<li>Cuando ambas claves CVEGEO son iguales (La clave del punto espacial es la misma clave de la manzana)</li>
<li>Cuando ambas claves CVEGEO son distintas (La clave asignada al punto espacial no pertenece a la manzana)</li>
</ol>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Total de puntos con claves diferentes: "</span>, MANZANA_911.query(<span class="st">'CVEGEO_left != CVEGEO_right'</span>).shape[<span class="dv">0</span>])</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Total de puntos con claves iguales: "</span>, MANZANA_911.query(<span class="st">'CVEGEO_left == CVEGEO_right'</span>).shape[<span class="dv">0</span>])</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Total de puntos representados por las manzanas: "</span>, MANZANA_911.shape[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total de puntos con claves diferentes:  265646
Total de puntos con claves iguales:  25358
Total de puntos representados por las manzanas:  291004</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>¿Qué clave mantener? para este caso usaremos la clave de la derecha como asignacion principal y reduciremos la forma del dataframe con el numero de dimensiones a considerar para los conteos y renombramos aquellas donde sea neesario.</p>
</blockquote>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Selección de dimensiones</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>MANZANA_911_USE <span class="op">=</span> MANZANA_911[[<span class="st">'CVEGEO_left'</span>,<span class="st">'folio'</span>, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'Categoria'</span>,<span class="st">'Incidente'</span> ]].rename({<span class="st">'CVEGEO_left'</span>:<span class="st">'CVEGEO'</span>}, </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                                                                 axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>MANZANA_911_USE.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVEGEO</th>
      <th>folio</th>
      <th>Categoria</th>
      <th>Incidente</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0901000010898031</td>
      <td>C5/210103/00836</td>
      <td>Disturbio</td>
      <td>ESCANDALO</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0901000010898031</td>
      <td>C5/20211009/05576</td>
      <td>Administrativas</td>
      <td>EBRIO</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0901000010898031</td>
      <td>C5/20210828/00113</td>
      <td>Disturbio</td>
      <td>ESCANDALO</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0901000011472068</td>
      <td>C5/20210523/02237</td>
      <td>Disturbio</td>
      <td>FIESTA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0901000011472068</td>
      <td>C5/20210410/01013</td>
      <td>Administrativas</td>
      <td>EBRIO</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Validamos si existen repeticiones en las manzanas y observamos que tenemos “n-1” manzanas repetidas, lo que en automatico nos hace entender que existe un numero de categorias de la dimension incidente dentro de la manzana</p>
</blockquote>
<blockquote class="blockquote">
<p>En el proceso de validación de manzanas debemos ecordar que la relación es una colonia a muchas manzanas, por lo que una manzana no debe repetirse mas de una vez)</p>
</blockquote>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>MANZANA_911_USE.CVEGEO.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>0901700010494014    305
0900800010512032    288
0901600010497013    265
090160001011A013    236
0901500010894005    190
                   ... 
0900700011250008      1
090160001082A004      1
0901600010798015      1
0900700011496012      1
0900400010138017      1
Name: CVEGEO, Length: 39864, dtype: int64</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Retomamos parte de los procesos anteriores y aplicamos un dataframe dummys para contabilizar en este caso a nivel manzana</p>
</blockquote>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Creación del dataframe Dummy</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>MANZAS_911_DMY <span class="op">=</span> pd.get_dummies(MANZANA_911_USE, </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                                columns <span class="op">=</span> [<span class="st">"Incidente"</span>],</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                                prefix <span class="op">=</span> [<span class="st">"DM"</span>])</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co">### Ahora que tenemos nuestro dummy podemos contar, para esto agrupamos</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>MANZANA_911_DUMMMY <span class="op">=</span> pd.DataFrame(MANZAS_911_DMY.groupby([<span class="st">'CVEGEO'</span>]).agg({<span class="st">'DM_AGUA_N'</span>: <span class="st">'sum'</span>, </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_AGUA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_BASURA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_CORTO_ELE'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_DROGADO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_EBRIO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_ESCANDALO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_FIESTA'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_FUGAS_N'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_GRAFITI'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_PERSO_R'</span>: <span class="st">'sum'</span>,</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_VEHICULO'</span>: <span class="st">'sum'</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>                                                                          }).reset_index())</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>MANZANA_911_DUMMMY.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVEGEO</th>
      <th>DM_AGUA_N</th>
      <th>DM_AGUA_P</th>
      <th>DM_BASURA_P</th>
      <th>DM_CORTO_ELE</th>
      <th>DM_DROGADO</th>
      <th>DM_EBRIO</th>
      <th>DM_ESCANDALO</th>
      <th>DM_FIESTA</th>
      <th>DM_FUGAS_N</th>
      <th>DM_GRAFITI</th>
      <th>DM_PERSO_R</th>
      <th>DM_VEHICULO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0900200010010001</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0900200010010002</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0900200010010003</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0900200010010005</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0900200010010006</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Una vez realizado lo anterior, podemos validar que las manzanas no se repiten</p>
</blockquote>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>MANZANA_911_DUMMMY.CVEGEO.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>0900200010010001    1
0901100111041013    1
0901100111037022    1
0901100111037023    1
0901100111037024    1
                   ..
0900700010623021    1
0900700010623022    1
0900700010623023    1
0900700010623024    1
0901700011524025    1
Name: CVEGEO, Length: 39864, dtype: int64</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Como lo hicimos con anterioridad, unimos estos resulados con el frame de uso (DATA_FIN_USE) donde se alinearon las claves de colonias a manzanas con base al criterio de maxima área</p>
</blockquote>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Union de tablas por campo lave primaria "CVEGEO"</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>SOCIAL_FISICO_POINT <span class="op">=</span> DATA_FIN_USE.merge(MANZANA_911_DUMMMY,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>                                         left_on <span class="op">=</span> <span class="st">'CVEGEO'</span>,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>                                         right_on <span class="op">=</span> <span class="st">'CVEGEO'</span>,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>                                         how <span class="op">=</span> <span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="desorden-social-y-fisico-nivel-colonia" class="level3" data-number="5.1.7">
<h3 data-number="5.1.7" class="anchored" data-anchor-id="desorden-social-y-fisico-nivel-colonia"><span class="header-section-number">5.1.7</span> Desorden Social y Fisico nivel colonia</h3>
<blockquote class="blockquote">
<p>Para construirlo repetimos los procesos anteriores para agrupacion y aplicacion de la función. Desorden social</p>
</blockquote>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Agrupamiento de datos por nivel colonia para "PCA" DESORDEN SOCIAL</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>SOC_POINT_COL <span class="op">=</span> pd.DataFrame(SOCIAL_FISICO_POINT.groupby([<span class="st">'CVE_COL'</span>]).agg({<span class="st">'POBTOT'</span>:<span class="st">'sum'</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_DROGADO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_EBRIO'</span>:<span class="st">'sum'</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_ESCANDALO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_FIESTA'</span>:<span class="st">'sum'</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_BASURA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>                                                                           <span class="st">'DM_PERSO_R'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>SOCIAL_PNT_COL <span class="op">=</span> CONC_DIS(SOC_POINT_COL, <span class="st">'CVE_COL'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>SOCIAL_PNT_COL.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 57.266 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="66">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVE_COL</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02-001</td>
      <td>-0.813810</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-002</td>
      <td>0.589982</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Desorden fisico</p>
</blockquote>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Desorden Fisico a nivel colonia</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>FISI_POINT_COL <span class="op">=</span> pd.DataFrame(SOCIAL_FISICO_POINT.groupby([<span class="st">'CVE_COL'</span>]).agg({<span class="st">'POBTOT'</span>:<span class="st">'sum'</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">'DM_VEHICULO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">'DM_GRAFITI'</span>:<span class="st">'sum'</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">'DM_AGUA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">'DM_AGUA_N'</span>:<span class="st">'sum'</span>,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">'DM_CORTO_ELE'</span>: <span class="st">'sum'</span>,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">'DM_FUGAS_N'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>FISICO_PNT_COL <span class="op">=</span> CONC_DIS(FISI_POINT_COL, <span class="st">'CVE_COL'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>FISICO_PNT_COL.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 31.155 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="67">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CVE_COL</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>02-001</td>
      <td>-0.955072</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02-002</td>
      <td>-0.187857</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="desorden-social-y-fisico-nivel-alcaldia" class="level3" data-number="5.1.8">
<h3 data-number="5.1.8" class="anchored" data-anchor-id="desorden-social-y-fisico-nivel-alcaldia"><span class="header-section-number">5.1.8</span> Desorden Social y Fisico nivel Alcaldia</h3>
<blockquote class="blockquote">
<p>Desorden social</p>
</blockquote>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Desorden social a nivel alcaldia</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>SOC_POINT_MUN <span class="op">=</span> pd.DataFrame(SOCIAL_FISICO_POINT.groupby([<span class="st">'MUN'</span>]).agg({<span class="st">'POBTOT'</span>:<span class="st">'sum'</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="st">'DM_DROGADO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="st">'DM_EBRIO'</span>:<span class="st">'sum'</span>,</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="st">'DM_ESCANDALO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="st">'DM_FIESTA'</span>:<span class="st">'sum'</span>,</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="st">'DM_BASURA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>                                                                       <span class="st">'DM_PERSO_R'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>SOCIAL_PNT_MUN <span class="op">=</span> CONC_DIS(SOC_POINT_MUN, <span class="st">'MUN'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>SOCIAL_PNT_MUN.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 86.8 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="68">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>-0.747695</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>0.735993</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Desorden Fisico</p>
</blockquote>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Desorden Fisico a nivel Alcaldia</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>FISI_POINT_MUN <span class="op">=</span> pd.DataFrame(SOCIAL_FISICO_POINT.groupby([<span class="st">'MUN'</span>]).agg({<span class="st">'POBTOT'</span>:<span class="st">'sum'</span>,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'DM_VEHICULO'</span>: <span class="st">'sum'</span>,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'DM_GRAFITI'</span>:<span class="st">'sum'</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'DM_AGUA_P'</span>: <span class="st">'sum'</span>,</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'DM_AGUA_N'</span>:<span class="st">'sum'</span>,</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'DM_CORTO_ELE'</span>: <span class="st">'sum'</span>,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="st">'DM_FUGAS_N'</span>: <span class="st">'sum'</span>}).reset_index())</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>FISICO_PNT_MUN <span class="op">=</span> CONC_DIS(FISI_POINT_MUN, <span class="st">'MUN'</span>,<span class="st">'POBTOT'</span>)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>FISICO_PNT_MUN.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Total de la variancia explicada 
 67.796 %</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="69">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>-0.557310</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>0.588662</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Ahora unimos toda la informacion la tabla con las desventajas y renombramos las columnas de lo necesario en cada nivel</p>
</blockquote>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Unimos toda la información a la tabla original y renombramos las columnas de lo necesario en cada nivel</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>MERGE_SOCIAL_POINT <span class="op">=</span> MERGE_DESVENTAJAS.merge(SOCIAL_PNT_COL,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                                             left_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                                             right_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>                                             how <span class="op">=</span> <span class="st">'inner'</span>).merge(SOCIAL_PNT_MUN,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>                                                                  left_on <span class="op">=</span><span class="st">'MUN'</span>,</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>                                                                  right_on <span class="op">=</span> <span class="st">'MUN'</span>,</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>                                                                  how <span class="op">=</span> <span class="st">'inner'</span>).rename({<span class="st">"DISAD_x"</span>: <span class="st">"SOCIAL_COL"</span>, </span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>                                                                                         <span class="st">"DISAD_y"</span>: <span class="st">"SOCIAL_MUN"</span>}, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>MERGE_FISICO_POINT <span class="op">=</span> MERGE_SOCIAL_POINT.merge(FISICO_PNT_COL,</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>                                              left_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>                                              right_on <span class="op">=</span> <span class="st">'CVE_COL'</span>, </span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>                                              how <span class="op">=</span> <span class="st">'inner'</span>).merge(FISICO_PNT_MUN,</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>                                                                   left_on <span class="op">=</span><span class="st">'MUN'</span>,</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>                                                                   right_on <span class="op">=</span> <span class="st">'MUN'</span>,</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>                                                                   how <span class="op">=</span> <span class="st">'inner'</span>).rename({<span class="st">"DISAD_x"</span>: <span class="st">"FISICO_COL"</span>,</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>                                                                                    <span class="st">"DISAD_y"</span>: <span class="st">"FISICO_MUN"</span>}, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>MERGE_FISICO_POINT.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>ID_COL</th>
      <th>CVE_COL</th>
      <th>NOM_COL</th>
      <th>AGEB</th>
      <th>...</th>
      <th>PROM_OCUP</th>
      <th>P3YM_HLI</th>
      <th>P_15A24_M</th>
      <th>geometry</th>
      <th>DIS_COL</th>
      <th>DIS_MUN</th>
      <th>SOCIAL_COL</th>
      <th>SOCIAL_MUN</th>
      <th>FISICO_COL</th>
      <th>FISICO_MUN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>...</td>
      <td>4.04</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>POLYGON ((-99.22982 19.35939, -99.23006 19.359...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>0.202823</td>
      <td>0.868655</td>
      <td>-0.130865</td>
      <td>1.464524</td>
    </tr>
    <tr>
      <th>1</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0900</td>
      <td>...</td>
      <td>4.39</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>POLYGON ((-99.23003 19.35814, -99.23091 19.357...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>0.202823</td>
      <td>0.868655</td>
      <td>-0.130865</td>
      <td>1.464524</td>
    </tr>
    <tr>
      <th>2</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>...</td>
      <td>3.54</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>POLYGON ((-99.22965 19.35917, -99.22977 19.359...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>0.202823</td>
      <td>0.868655</td>
      <td>-0.130865</td>
      <td>1.464524</td>
    </tr>
    <tr>
      <th>3</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0900</td>
      <td>...</td>
      <td>3.08</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>POLYGON ((-99.22887 19.35633, -99.22904 19.356...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>0.202823</td>
      <td>0.868655</td>
      <td>-0.130865</td>
      <td>1.464524</td>
    </tr>
    <tr>
      <th>4</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0900</td>
      <td>...</td>
      <td>3.63</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>POLYGON ((-99.22885 19.35836, -99.22903 19.358...</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>0.202823</td>
      <td>0.868655</td>
      <td>-0.130865</td>
      <td>1.464524</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Ahora si, tenemos la base como la necesitamos ahora con la bifurcacion de puntos. Solo nos queda reordenar y validar</p>
</blockquote>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Solo queda reordenar para un uso mas facil</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>DATA_SET_FINAL_POINT <span class="op">=</span> MERGE_FISICO_POINT[[<span class="st">'ENTIDAD'</span>, <span class="st">'NOM_ENT'</span>, <span class="st">'MUN'</span>, <span class="st">'NOM_MUN'</span>, <span class="st">'LOC'</span>, <span class="st">'NOM_LOC'</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'ID_COL'</span>,<span class="st">'CVE_COL'</span>, <span class="st">'NOM_COL'</span>, <span class="st">'AGEB'</span>, <span class="st">'MZA'</span>, <span class="st">'CVEGEO'</span>, </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'POBTOT'</span>,<span class="st">'DIS_COL'</span>, <span class="st">'DIS_MUN'</span>, <span class="st">'SOCIAL_COL'</span>, <span class="st">'SOCIAL_MUN'</span>, </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'FISICO_COL'</span>,<span class="st">'FISICO_MUN'</span>, <span class="st">'geometry'</span>]]</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>DATA_SET_FINAL_POINT.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ENTIDAD</th>
      <th>NOM_ENT</th>
      <th>MUN</th>
      <th>NOM_MUN</th>
      <th>LOC</th>
      <th>NOM_LOC</th>
      <th>ID_COL</th>
      <th>CVE_COL</th>
      <th>NOM_COL</th>
      <th>AGEB</th>
      <th>MZA</th>
      <th>CVEGEO</th>
      <th>POBTOT</th>
      <th>DIS_COL</th>
      <th>DIS_MUN</th>
      <th>SOCIAL_COL</th>
      <th>SOCIAL_MUN</th>
      <th>FISICO_COL</th>
      <th>FISICO_MUN</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0898</td>
      <td>031</td>
      <td>0901000010898031</td>
      <td>93.0</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>0.202823</td>
      <td>0.868655</td>
      <td>-0.130865</td>
      <td>1.464524</td>
      <td>POLYGON ((-99.22982 19.35939, -99.23006 19.359...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>09</td>
      <td>Ciudad de México</td>
      <td>010</td>
      <td>Álvaro Obregón</td>
      <td>0001</td>
      <td>Álvaro Obregón</td>
      <td>1656</td>
      <td>10-085</td>
      <td>HERON PROAL</td>
      <td>0900</td>
      <td>019</td>
      <td>0901000010900019</td>
      <td>101.0</td>
      <td>-0.58736</td>
      <td>0.533438</td>
      <td>0.202823</td>
      <td>0.868655</td>
      <td>-0.130865</td>
      <td>1.464524</td>
      <td>POLYGON ((-99.23003 19.35814, -99.23091 19.357...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Hacemos otro mapita :D</p>
</blockquote>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Mapitas y mas mapitas </span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>DATA_SET_FINAL_POINT.plot(<span class="st">'SOCIAL_MUN'</span>, </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                          legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                          alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>                          scheme<span class="op">=</span><span class="st">'NaturalBreaks'</span>,</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>                          cmap<span class="op">=</span><span class="st">'copper'</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>                          classification_kwds<span class="op">=</span>{<span class="st">'k'</span>:<span class="dv">6</span>}, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>plt.title(label <span class="op">=</span> <span class="st">'Desorden Social nivel Alcaldia, Ciudad de México'</span>)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data_files/figure-html/cell-74-output-1.png" width="504" height="631"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Validamos la información</p>
</blockquote>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">### validamos la informacion de las dimensiones creadas</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>DATA_SET_FINAL_POINT.groupby([<span class="st">'MUN'</span>]).agg({<span class="st">'DIS_COL'</span>:<span class="st">'mean'</span>,</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'DIS_MUN'</span>: <span class="st">'mean'</span>,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'SOCIAL_COL'</span>:<span class="st">'mean'</span>,</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'SOCIAL_MUN'</span>: <span class="st">'mean'</span>,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'FISICO_COL'</span>:<span class="st">'mean'</span>,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'FISICO_MUN'</span>: <span class="st">'mean'</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>                                           }).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>DIS_COL</th>
      <th>DIS_MUN</th>
      <th>SOCIAL_COL</th>
      <th>SOCIAL_MUN</th>
      <th>FISICO_COL</th>
      <th>FISICO_MUN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>-0.312325</td>
      <td>-0.996294</td>
      <td>0.296621</td>
      <td>-0.747695</td>
      <td>-0.019401</td>
      <td>-0.557310</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>-0.006193</td>
      <td>-0.069455</td>
      <td>0.589519</td>
      <td>0.735993</td>
      <td>0.488595</td>
      <td>0.588662</td>
    </tr>
    <tr>
      <th>2</th>
      <td>004</td>
      <td>1.106869</td>
      <td>-1.304359</td>
      <td>-0.047840</td>
      <td>-2.958135</td>
      <td>0.185149</td>
      <td>-2.564519</td>
    </tr>
    <tr>
      <th>3</th>
      <td>005</td>
      <td>0.565336</td>
      <td>2.040898</td>
      <td>0.736651</td>
      <td>3.405017</td>
      <td>0.472610</td>
      <td>3.112129</td>
    </tr>
    <tr>
      <th>4</th>
      <td>006</td>
      <td>1.201381</td>
      <td>-0.650310</td>
      <td>2.142924</td>
      <td>-0.475565</td>
      <td>1.298131</td>
      <td>-0.760101</td>
    </tr>
    <tr>
      <th>5</th>
      <td>007</td>
      <td>1.719481</td>
      <td>5.736332</td>
      <td>0.746890</td>
      <td>5.601105</td>
      <td>0.399379</td>
      <td>4.488746</td>
    </tr>
    <tr>
      <th>6</th>
      <td>008</td>
      <td>0.868157</td>
      <td>-1.099762</td>
      <td>1.060475</td>
      <td>-2.284766</td>
      <td>1.633729</td>
      <td>-1.722324</td>
    </tr>
    <tr>
      <th>7</th>
      <td>009</td>
      <td>4.909275</td>
      <td>-1.163220</td>
      <td>0.467193</td>
      <td>-3.390534</td>
      <td>0.099637</td>
      <td>-2.940692</td>
    </tr>
    <tr>
      <th>8</th>
      <td>010</td>
      <td>0.126637</td>
      <td>0.533438</td>
      <td>-0.016423</td>
      <td>0.868655</td>
      <td>0.569073</td>
      <td>1.464524</td>
    </tr>
    <tr>
      <th>9</th>
      <td>011</td>
      <td>1.633560</td>
      <td>-0.609511</td>
      <td>0.904822</td>
      <td>-2.098129</td>
      <td>1.112164</td>
      <td>-1.533676</td>
    </tr>
    <tr>
      <th>10</th>
      <td>012</td>
      <td>0.829067</td>
      <td>0.688221</td>
      <td>0.330175</td>
      <td>0.302626</td>
      <td>0.902628</td>
      <td>1.025731</td>
    </tr>
    <tr>
      <th>11</th>
      <td>013</td>
      <td>2.961643</td>
      <td>0.183677</td>
      <td>1.138957</td>
      <td>-1.722297</td>
      <td>0.882234</td>
      <td>-1.450689</td>
    </tr>
    <tr>
      <th>12</th>
      <td>014</td>
      <td>-0.000506</td>
      <td>-1.302296</td>
      <td>1.840254</td>
      <td>-0.076218</td>
      <td>1.148156</td>
      <td>0.088225</td>
    </tr>
    <tr>
      <th>13</th>
      <td>015</td>
      <td>1.070981</td>
      <td>-0.151071</td>
      <td>3.577664</td>
      <td>1.966882</td>
      <td>1.983134</td>
      <td>2.494758</td>
    </tr>
    <tr>
      <th>14</th>
      <td>016</td>
      <td>-0.491578</td>
      <td>-1.227027</td>
      <td>0.842559</td>
      <td>-0.304295</td>
      <td>0.177206</td>
      <td>-1.333774</td>
    </tr>
    <tr>
      <th>15</th>
      <td>017</td>
      <td>0.548961</td>
      <td>-0.609259</td>
      <td>2.127434</td>
      <td>1.177357</td>
      <td>0.872103</td>
      <td>-0.399690</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>SOCIAL_PNT_MUN.head(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>MUN</th>
      <th>DISAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>002</td>
      <td>-0.747695</td>
    </tr>
    <tr>
      <th>1</th>
      <td>003</td>
      <td>0.735993</td>
    </tr>
    <tr>
      <th>2</th>
      <td>004</td>
      <td>-2.958135</td>
    </tr>
    <tr>
      <th>3</th>
      <td>005</td>
      <td>3.405017</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="resultados" class="level3" data-number="5.1.9">
<h3 data-number="5.1.9" class="anchored" data-anchor-id="resultados"><span class="header-section-number">5.1.9</span> Resultados</h3>
<blockquote class="blockquote">
<p>Resumimos los resultados en dos tablas que nos hablan del valor de la varianza por ambos caminos de bifurcación <a href="#tbl-panel">Table&nbsp;<span>5.1</span></a></p>
</blockquote>
<div id="tbl-panel" class="tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;5.1: Resultados</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-first" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(a) Clave Manzana</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Caso 01</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Colonia</td>
<td style="text-align: left;">Social</td>
<td style="text-align: left;">61.258%</td>
<td style="text-align: left;">Fisico</td>
<td style="text-align: left;">35.943%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcaldia</td>
<td style="text-align: left;">Social</td>
<td style="text-align: left;">76.681%</td>
<td style="text-align: left;">Fisico</td>
<td style="text-align: left;">60.443%</td>
</tr>
</tbody>
</table>
</div>
<div id="tbl-second" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(b) Geom Point</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Caso 02</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Colonia</td>
<td style="text-align: left;">Social</td>
<td style="text-align: left;">57.266%</td>
<td style="text-align: left;">Fisico</td>
<td style="text-align: left;">31.155%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcaldia</td>
<td style="text-align: left;">Social</td>
<td style="text-align: left;">86.8%</td>
<td style="text-align: left;">Fisico</td>
<td style="text-align: left;">67.796%</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./methods.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methods</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>